;-------------------------
;精液マップを作成
;下に下に追加していくこと
;-------------------------
;精液マップを作成
;下に下に追加していくこと
;-------------------------
@CREATE_SPERM_MAP
;不明のみ0と1が存在する
SPERM_NAME_ARRAY:0 = 不明
CALL ADD_SPERM("野盗")
CALL ADD_SPERM("ホフゴブリン")
CALL ADD_SPERM("外来人")
CALL ADD_SPERM("触手")
CALL ADD_SPERM("自警団")
CALL ADD_SPERM("サキュバス")
CALL ADD_SPERM("「実験動物」")
CALL ADD_SPERM("犬")
CALL ADD_SPERM("豚")
CALL ADD_SPERM("馬")
CALL ADD_SPERM("薬売り")
CALL ADD_SPERM("金貸しの客")
CALL ADD_SPERM("催眠術師")
CALL ADD_SPERM("娼館の客")
CALL ADD_SPERM("兵士")
CALL ADD_SPERM("鬼")
CALL ADD_SPERM("野良妖怪")
CALL ADD_SPERM("浮浪者")
CALL ADD_SPERM("チャラ男")
CALL ADD_SPERM("山賊")
CALL ADD_SPERM("やくざ")
CALL ADD_SPERM("チンピラ")
CALL ADD_SPERM("ごろつき")
CALL ADD_SPERM("奴隷商人")
CALL ADD_SPERM("痴漢")
CALL ADD_SPERM("子供")
CALL ADD_SPERM("地主")
CALL ADD_SPERM("ならず者")
CALL ADD_SPERM("行きずりの男")
CALL ADD_SPERM("医者")
CALL ADD_SPERM("貴族")
CALL ADD_SPERM("領民")
CALL ADD_SPERM("老人")
CALL ADD_SPERM("悪魔")
CALL ADD_SPERM("ゾンビ")
CALL ADD_SPERM("天狗")
CALL ADD_SPERM("オーク")
CALL ADD_SPERM("AV男優")
CALL ADD_SPERM("カジノの客")


;-------------------------
;指定した名前をもつ精液を追加
;二重登録禁止
;-------------------------
@ADD_SPERM(SPERMNAME)
#DIMS SPERMNAME
;登録済みならスルー
SIF FINDELEMENT(SPERM_NAME_ARRAY, SPERMNAME) != -1
	RETURN 0
FOR LOCAL, 0, SPERM_MAX_ADDRESS
	IF SPERM_NAME_ARRAY:LOCAL == ""
		LOCAL:1 = LOCAL
		LOCAL --
		BREAK
	ENDIF
NEXT

SIF LOCAL == SPERM_MAX_ADDRESS
	THROW SPERM_NAME_ARRAYがいっぱいです

PRINTFORML %SPERMNAME% {FINDELEMENT(SPERM_NAME_ARRAY, SPERMNAME)}, {LOCAL:1}
SPERM_NAME_ARRAY:(LOCAL:1) = %SPERMNAME%

RETURN 1

;-------------------------
;指定した名前をもつ精液のIDを取得
;-------------------------
@GET_SPERM_ID(SPERMNAME)
#FUNCTION
#DIMS SPERMNAME
SIF SPERMNAME == "不明"
	RETURNF -1
LOCAL = FINDELEMENT(SPERM_NAME_ARRAY, SPERMNAME)
IF LOCAL == -1
	PRINTFORML ADD_SPERMされていない精液"%SPERMNAME%"がGET_SPERM_IDに渡されました
	PRINTFORML バリアントないしパッチ製作者に報告願います
	RETURNF 0
ENDIF
RETURNF LOCAL * -1

;-------------------------
;指定したIDをもつ精液の名前を取得
;-------------------------
@GET_SPERM_NAME(SPERMID)
#FUNCTIONS
#DIM SPERMID
IF SPERMID > 0
	LOCAL = ID_TO_CHARA(SPERMID)
	SIF LOCAL == -1
		RETURNF "不明"
	RETURNF ANAME(LOCAL)
ENDIF
LOCALS = %SPERM_NAME_ARRAY:(SPERMID * -1)%
SIF LOCALS == ""
	RETURNF "不明"
RETURNF LOCALS