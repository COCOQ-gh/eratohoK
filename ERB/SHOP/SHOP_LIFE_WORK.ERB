
;-------------------------------------------------
;労働
;-------------------------------------------------
@SHOP_LIFE_WORK(対象)
#DIM 対象, 1
#DIM 結果, 1
#DIM 全消費, 1
#DIM 内容, 1
#DIM 報酬, 1
#DIM 能力, 1
#DIM 経験値, 1
DRAWLINE
PRINTFORML 行動回数を消費し、%ANAME(対象)%が働いてお金を稼ぎます
PRINTFORML 職種次第では、そのほかの恩恵も得られるでしょう
PRINTFORML どうやってお金を稼ぎますか？
PRINTFORML 現在の体力:{BASE:対象:体力} / {MAXBASE:対象:体力}
PRINTFORML 残り行動回数:{CALC_SHOP_TIME() - SHOP_TIME}
DRAWLINE
PRINTBUTTON @"%"[鉱山労働]", 12, LEFT%", 1
PRINTBUTTON "[行動全消費]", 11
PRINTL   鉱山で働いて稼ぎます。武闘が影響します。
PRINTBUTTON @"%"[軍事広報]", 12, LEFT%", 1
PRINTBUTTON "[行動全消費]", 11
PRINTL   軍の広報活動を手伝います。知略が影響します。
PRINTBUTTON @"%"[街の宣伝]", 12, LEFT%", 3
PRINTBUTTON "[行動全消費]", 13
PRINTL   街の宣伝活動を手伝います。政治が影響します。
PRINTBUTTON @"%"[炊き出し]", 12, LEFT%", 4
PRINTBUTTON "[行動全消費]", 14
PRINTL   炊き出しを手伝います。料理が影響します。
PRINTBUTTON @"%"[ライブ]", 12, LEFT%", 5
PRINTBUTTON "[行動全消費]", 15
PRINTL   ストリートライブで稼ぎます。歌唱が影響します。
IF ABL:対象:性技 >= ランク閾値_その他_C
	PRINTBUTTON @"%"[娼婦]", 12, LEFT%", 6
	PRINTBUTTON "[行動全消費]", 16
	PRINTL   娼婦として働きます。スケベな経験が増えます。スケベな能力が影響します。
ELSE
	SETCOLOR COLOR("選択不可")
	PRINTPLAINFORM [娼婦として働くには、%ANAME(対象)%の性技は未熟です]
	RESETCOLOR
	PRINTL
ENDIF
DRAWLINE
PRINTBUTTON "[0] - 戻る", 0
$INPUT_LOOP
INPUT

内容 = RESULT
;0だったら戻す
IF 内容 == 0
	RETURN 0
ENDIF

IF GROUPMATCH(内容, 11, 12, 13, 14, 15, 16)
	全消費 = 1
	内容 -= 10
ELSEIF GROUPMATCH(内容, 1, 2, 3, 4, 5, 6)
	全消費 = 0
ELSE
	GOTO INPUT_LOOP
ENDIF

IF 内容 == 6 && ABL:対象:性技 < ランク閾値_その他_C
	GOTO INPUT_LOOP
ENDIF

$WORK_LOOP

BASE:対象:体力 = MAX(BASE:対象:体力 - RAND(600, 800), 0)

SELECTCASE RAND:100
	CASE 0 TO 19
		結果 = 0
	CASE 20 TO 79
		結果 = 1
	CASEELSE
		結果 = 2
ENDSELECT

IF BASE:対象:体力 <= 0 || RAND:100 < SHOP_WORK_COUNT
	LOCAL = RAND:3 + 1
	SETCOLOR COLOR("警告")
	PRINTFORMW うわぁっ！！
	RESETCOLOR
	PRINTFORMW     ・
	PRINTFORMW     ・
	PRINTFORMW     ・
	PRINTFORMW 仕事中に大失敗し、ケガをしてしまった
	SETCOLOR COLOR("警告")
	PRINTFORMW %ANAME(対象)%に{LOCAL}ターンのクールタイムが課せられた
	RESETCOLOR
	COOLTIME:対象:0 += LOCAL
	SHOP_TIME += 1
	RESULT = 0
	BEGIN TURNEND
ENDIF

SELECTCASE 内容
	CASE 1
		PRINTFORML %ANAME(対象)%は鉱山で働いた……
		能力 = GETNUM(ABL, "武闘")
		経験値 = GETNUM(EXP, "武闘経験値")
	CASE 2
		PRINTFORML %ANAME(対象)%は軍事広報を手伝った……
		能力 = GETNUM(ABL, "知略")
		経験値 = GETNUM(EXP, "知略経験値")
		;LOCAL:1 = (500 + RAND(MAX(ABL:対象:知略 * 5, 1), MAX(ABL:対象:知略 * 10, 1)) / (SHOP_WORK_COUNT + 1)
		;COUNTRY_SOLDIER:(CFLAG:対象:1) += LOCAL:1
		;PRINTFORML 兵が{LOCAL:1}人増えた
	CASE 3
		PRINTFORML %ANAME(対象)%は街の宣伝活動を手伝った……
		能力 = GETNUM(ABL, "政治")
		経験値 = GETNUM(EXP, "政治経験値")
		;LOCAL:1 = (3000 + RAND(MAX(ABL:対象:政治 * 50, 1), MAX(ABL:対象:政治 * 100, 100))) / (SHOP_WORK_COUNT + 1)
		;CALL FISHER_YATES_SHAFFLE(MAX_CITY)
		;FOR LOCAL, 0, MAX_CITY
		;	IF CITY_OWNER:(SHAFFLE_ARRAY:LOCAL) == CFLAG:対象:1 && CITY_ECONOMY:(SHAFFLE_ARRAY:LOCAL) < CITY_ECONOMY_LIMIT:(SHAFFLE_ARRAY:LOCAL)
		;		LOCAL:1 = MIN(LOCAL:1, CITY_ECONOMY_LIMIT:(SHAFFLE_ARRAY:LOCAL) - CITY_ECONOMY:(SHAFFLE_ARRAY:LOCAL))
		;		CITY_ECONOMY:(SHAFFLE_ARRAY:LOCAL) += LOCAL:1
		;		PRINTFORML %GET_CITYNAME(SHAFFLE_ARRAY:LOCAL)%の経済が{LOCAL:1 / 100}成長した
		;		BREAK
		;	ENDIF
		;NEXT
	CASE 4
		PRINTFORML %ANAME(対象)%は炊き出しに出かけた……
		能力 = GETNUM(ABL, "料理")
		経験値 = GETNUM(EXP, "料理経験値")
	CASE 5
		PRINTFORML %ANAME(対象)%はストリートライブで稼いだ……
		能力 = GETNUM(ABL, "歌唱")
		経験値 = GETNUM(EXP, "歌唱経験値")
	CASE 6
		PRINTFORMW %ANAME(対象)%は娼館で働いた……
		PRINTFORML 
		IF IS_FEMALE(対象)
			CALL SHOP_LIFE_WORK_WHORE_TEXT(対象)
		ENDIF
		報酬 = 1500
		SIF TALENT:対象:処女
			報酬 += 10000
		報酬 += RAND:(MAX((ABL:対象:欲望 * 3 + ABL:対象:性技 * 3 + ABL:対象:奉仕 * 2 + ABL:対象:性交 * 2) * 10, 1))
		CALL VIRGIN_COMMON(対象, "娼館の客")
		;ペニスへのキス
		CALL KISS_COMMON(対象, "娼館の客のペニス")

		;唇へのキス
		CALL KISS_COMMON(対象, "娼館の客の唇")

		;経験値は性処理より低い
		IF !VAGINA(対象)
			EXP:対象:Ｃ感経験値 += ABL:対象:Ｃ感
			EXP:対象:Ａ感経験値 += ABL:対象:Ａ感 + 5
		ELSE
			EXP:対象:Ｃ感経験値 += ABL:対象:Ｃ感
			EXP:対象:Ｖ感経験値 += ABL:対象:Ｖ感 + 5
			EXP:対象:Ａ感経験値 += ABL:対象:Ａ感 + 5
		ENDIF

		EXP:対象:Ｂ感経験値 += ABL:対象:Ｂ感 + RAND:3
		EXP:対象:Ｍ感経験値 += ABL:対象:Ｍ感 + RAND:3
		EXP:対象:欲望経験値 += ABL:対象:欲望 + (LOCAL:1 / 2)
		EXP:対象:奉仕経験値 += ABL:対象:奉仕 + RAND:3
		EXP:対象:性交経験値 += ABL:対象:性交 + RAND:3
	CASEELSE
		GOTO INPUT_LOOP
ENDSELECT

IF 内容 != 6
	報酬 = 2000
	SELECTCASE 能力
		CASE GETNUM(ABL, "武闘"), GETNUM(ABL, "知略"), GETNUM(ABL, "政治")
			報酬 += RAND:(MAX(ABL:対象:能力 * 10, 1))
		CASE GETNUM(ABL, "料理"), GETNUM(ABL, "歌唱")
			報酬 += RAND:(MAX(ABL:対象:能力 * 20, 1))
	ENDSELECT
	SELECTCASE 経験値
		CASE GETNUM(EXP, "武闘経験値"), GETNUM(EXP, "知略経験値"), GETNUM(EXP, "政治経験値")
			CALL PRINT_ADD_EXP(対象, EXPNAME:(経験値), MAX(RAND:(ABLUP_NEED_EXP_SLG_THREE(ABL:対象:能力)) / (SHOP_WORK_COUNT + 1) / 100, 1))
		CASE GETNUM(EXP, "料理経験値"), GETNUM(EXP, "歌唱経験値")
			CALL PRINT_ADD_EXP(対象, EXPNAME:(経験値), MAX(RAND:(ABLUP_NEED_EXP_SLG_TWO(ABL:対象:能力)) / (SHOP_WORK_COUNT + 1) / 100, 1))
	ENDSELECT
	CALL TRAIN_AUTO_ABLUP(対象)
ENDIF

報酬 /= (SHOP_WORK_COUNT + 1)
報酬 += RAND:500

PRINTFORML
SELECTCASE 結果
	CASE 0
		PRINTFORML どうもうまくできなかった……
		TIMES 報酬, 0.70
	CASE 2
		PRINTFORML 中々うまくできた……
		TIMES 報酬, 1.30
ENDSELECT

PRINTFORML 金{報酬}を得た

MONEY += 報酬

PRINTFORMW 
SHOP_TIME += 1
SHOP_WORK_COUNT += 1
CFLAG:対象:行動済み = 1
IF SHOP_TIME < CALC_SHOP_TIME()
	CALL COOK_HEAL(対象)
	SIF 全消費
		GOTO WORK_LOOP
	RESTART
ENDIF
RESULT = 0
BEGIN TURNEND

;-------------------------------------------------
;娼館で働いた場合のテキスト
;-------------------------------------------------
@SHOP_LIFE_WORK_WHORE_TEXT(対象)
#DIM 対象
IF TALENT:対象:処女 == 1
	PRINTFORML %ANAME(対象)%がベッドに腰掛け緊張して待っていると、やがて一人の客が案内されてやってきた
	PRINTFORMW 恰幅の良い中年男性だ、彼は%ANAME(対象)%っを見ると期限良さそうに笑い舌なめずりをした
	PRINTFORMW 彼が%ANAME(対象)%の初物を買う為に大金を出した客の様だ
	PRINTFORML 男は%ANAME(対象)%の隣に座り、肩に手を回して体を寄せさせると、早速服の上から身体を弄りだした
	PRINTFORML 欲望のままに胸や秘所を弄られ、頬や首筋を舐められ、%ANAME(対象)%は嫌悪感で思わず顔を背けてしまう
	PRINTFORMW しかしその初々しい反応に彼はますます興奮し、鼻息を荒くしてより一層激しく弄る
	PRINTFORML やがて、%ANAME(対象)%の秘所がしっとりと濡れだすと、男は乱暴に%ANAME(対象)%の唇を奪い
	PRINTFORMW 恐怖とショックでこわばる%ANAME(対象)%を押し倒し、服を脱ぐと、はち切れんばかりの肉棒を取りだした
	PRINTFORML 初めて見る男根に釘付けになる%ANAME(対象)%を見て、男はニヤニヤと笑いながら%ANAME(対象)%の脚を開き
	PRINTFORMW 濡れぼそったピンクの割れ目に、二度三度とペニスを擦り付けてから、ずぶりとペニスを挿入した
	PRINTFORML %ANAME(対象)%はあまりの痛みに思わず悲鳴を上げそうになるが、シーツを掴んで必死でこらえる
	PRINTFORML 男はそんな%ANAME(対象)%の反応を愉しむ様に、ゆっくりとゆっくりと腰を沈めていく
	PRINTFORMW そして男のペニスが深々と挿入されると、男は一旦腰の動きを止め、再び%ANAME(対象)%と濃厚なキスをする
	PRINTFORML 男と全身が密着した格好で、%ANAME(対象)%は痛みで涙を流しながら、痛みを紛らわせようと彼に抱きつく
	PRINTFORMW 10分ほどそのままでいたが、やがて男が上体を起こし、ゆるゆると腰を動かし始めた
	PRINTFORML 仕事の前に飲まされた薬の効果だろうか、%ANAME(対象)%は先ほど感じた痛みはもうほとんど感じておらず
	PRINTFORMW それどころか下半身から痺れるような快感を徐々に感じ始めていた
	PRINTFORML 男のペニスが膣を行ったり来たりする度に、%ANAME(対象)%は甘い声を漏らしビクビクと身体を震わせてしまう
	PRINTFORML その艶めかしい反応に気を良くした男は徐々に腰の動きを早めていく
	PRINTFORMW それに合わせて%ANAME(対象)%もまたリズミカルに喘ぎ声をあげ、未知の快感によって蕩けていく
	PRINTFORML やがて男が低く唸り、再び%ANAME(対象)%の最奥までペニスをねじ込んで、精を吐き出す
	PRINTFORML %ANAME(対象)%は不意に下腹部に感じた強烈な熱と、一拍遅れて訪れた強烈な快感に頭の中が真っ白になり
	PRINTFORMW 背中を大きく反らし、つま先までピンと伸ばしながら一際大きな嬌声を上げて、初めての絶頂を迎えた
	PRINTFORMW びゅるびゅると膣内に吐き出される男の精液に、%ANAME(対象)%はさらに二度三度と絶頂を続ける
	PRINTFORML やがて男が一息をついてペニスを抜き取ると、%ANAME(対象)%は惚けた様に力なくベッドに横たわっていた
	PRINTFORMW %ANAME(対象)%は息を荒げ胸を上下させながら、時折ピクピクと肢体を震わせる
	PRINTFORML その貫通したばかりの雌穴からは純血の証だった血とどろりとした白濁が垂れていた
	PRINTFORMW 涙を流しながらもその表情はどこか恍惚としており、夢見心地の様に視線を泳がせていた
	PRINTFORML 
	PRINTFORMW その後も、%ANAME(対象)%は一晩中男によって可愛がられ、何度も種付けされ、絶頂させられた
ELSE
	PRINTFORM 今日の客は
	SELECTCASE RAND:3
		CASE 0
		SELECTCASE RAND:3
			CASE 0
				PRINTFORML 一見普通の男性だった
				PRINTFORMW %ANAME(対象)%を見ると当たりだと呟き嬉しそうにしていた
			CASE 1
				PRINTFORML なんと我が軍の兵士だった
				PRINTFORMW %ANAME(対象)%を見ると一瞬驚いた顔をしたが、何も言われなかった
			CASE 2
				PRINTFORML オタク風の男だった
				PRINTFORMW %ANAME(対象)%を見ると興奮して息を荒げている
		ENDSELECT
		PRINTFORML 
		SELECTCASE RAND:4
			CASE 0
				PRINTFORML 前技をほどほどに済ませると、男は%ANAME(対象)%を押し倒し、ペニスを挿入してきた
				PRINTFORML ペニスもテクニックも並であったが、飲んでいた媚薬の効果で%ANAME(対象)%は否が応でも昂ぶっていく
				PRINTFORMW 男の腰が早まるのを感じ、膣を締め上げ射精を促して、男の射精と共に%ANAME(対象)%も絶頂した
			CASE 1
				PRINTFORML 男が%ANAME(対象)%を押し倒しその一物を取りだすと、あまりの逞しさに驚く
				PRINTFORML たじろぐ%ANAME(対象)%に男がペニスを文字通りねじ込んでいくと、余りの圧迫感に軽く達してしまう
				PRINTFORMW %ANAME(対象)%は辛うじて意識を保ちながら、男の巨大な一物に時間いっぱい蹂躙され続けた
			CASE 2
				PRINTFORML 何度目かの射精を受け、%ANAME(対象)%は大きく嬌声をあげ、ベッドに倒れ込んだ
				PRINTFORML 息絶え絶えの%ANAME(対象)%の雌穴からとめどなく精液が溢れているが、男の一物は今だ衰える様子はない
				PRINTFORMW %ANAME(対象)%の極上の身体に興奮が収まらない男に再びペニスをねじ込まれ、時間いっぱい蹂躙され続けた
			CASE 3
				PRINTFORM %ANAME(対象)%は男の持ってきた
				SELECTCASE RAND:3
					CASE 0
						PRINTFORM メイド服
					CASE 1
						PRINTFORM チャイナドレス
					CASE 2
						PRINTFORM ナース服
				ENDSELECT
				PRINTFORML に着替えさせられ、奉仕している
				PRINTFORML 興奮した男は鼻息を荒げながら腰を打ち付け、%ANAME(対象)%もそれに合わせてリズミカルに嬌声を上げる
				PRINTFORMW やがて男が子宮に精を解き放つと、%ANAME(対象)%も彼に抱きつきながら身を震わせて絶頂した
		ENDSELECT
		CASE 1
		SELECTCASE RAND:3
			CASE 0
				PRINTFORML 脂ぎった中年男性だった
				PRINTFORMW あまり触れたくはないが、仕事だと割り切り奉仕を開始した
			CASE 1
				PRINTFORML やくざ風の男だった
				PRINTFORMW 男は酷く馴れ馴れしいが、仕事だと割り切り奉仕を開始した
			CASE 2
				PRINTFORML 汚らしい浮浪者だった
				PRINTFORMW 逃げ出したい衝動をこらえ、仕事だと割り切り奉仕を開始した
		ENDSELECT
		PRINTFORML 
		SELECTCASE RAND:4
			CASE 0
				PRINTFORML 男は早速%ANAME(対象)%を押し倒すと、すでに勃起しきっているペニスを取りだし、挿入してきた
				PRINTFORML その荒々しい腰遣いに、%ANAME(対象)%の子宮も刺激され、徐々に疼いてしまう
				PRINTFORMW やがて男が射精すると、その熱を感じながら、あられもない嬌声を上げて絶頂してしまった
			CASE 1
				PRINTFORML 男はペニスを挿入したまま、ねちっこい指使いで%ANAME(対象)%の身体を弄繰り回す
				PRINTFORML 内と外から絶え間なく与えられる快感に、%ANAME(対象)%はたまらなくなり、男におねだりしてしまう
				PRINTFORMW ペニスに子宮口をグリグリと刺激されて絶頂する%ANAME(対象)%の中に、男のザーメンが注ぎ込まれた
			CASE 2
				PRINTFORML 男は四つん這いになっている%ANAME(対象)%の菊門に深々とペニスを差し込み、腰を振っている
				PRINTFORML 耐えがたい熱さと目が回りそうな快感で、%ANAME(対象)%はシーツを掴みながら必死で耐える
				PRINTFORMW やがて男のザーメンが腸内に放たれると、%ANAME(対象)%は気が狂いそうな熱を感じて絶頂した
			CASE 3
				PRINTFORML 男が%ANAME(対象)%を押さえつけながら、体重を乗せて激しくピストンをしている
				PRINTFORML 子宮を刺激する強烈な刺激に、%ANAME(対象)%は目を白黒させながらヨガり狂う
				PRINTFORMW やがて男が身震いすると、子宮内へ届く様に深々と腰を沈めて、思い切り種を注ぎ込んだ
		ENDSELECT
		CASE 2
		SELECTCASE RAND:2
			CASE 0
				PRINTFORML 年端もいかない少年だった
				PRINTFORMW おどおどしたその態度に母性を刺激され、優しく服を脱がせてやった
			CASE 1
				PRINTFORML いかにも童貞といった男性だった
				PRINTFORMW おどおどしたその態度を可愛く思い、緊張をほぐしながら服を脱がせてやった
		ENDSELECT
		PRINTFORML 
		SELECTCASE RAND:3
			CASE 0
				PRINTFORML %ANAME(対象)%が服を脱ぐと、彼は初めて見た女体に興奮し、乱暴に押し倒してきた
				PRINTFORML 夢中で%ANAME(対象)%の身体にしゃぶりつく彼を諌め、優しくリードしてやる
				PRINTFORMW やがて彼が%ANAME(対象)%の中で射精すると、%ANAME(対象)%も達しながら心が満たされるのを感じた
			CASE 1
				PRINTFORML 初めての彼を優しくベッドに寝かせ、リードしながらお互いの身体を愛撫しあう
				PRINTFORML 我慢汁が垂れ流しになったペニスの上に跨り、ゆっくりと挿入していくとそれだけで射精してしまった
				PRINTFORMW 慌てる彼をなだめながら、彼が心行くまで何度もその精を受け止めてやった
			CASE 2
				PRINTFORML しかし彼を脱がせると、その態度に似合わず巨大なペニスが現れ、思わず生唾を呑んでしまった
				PRINTFORML 少々戸惑いながらも、ペニスを導き挿入させると、その巨大さに一瞬意識が飛んでしまうほどだった
				PRINTFORMW 初心者の荒々しいピストンで%ANAME(対象)%の膣内は蹂躙され、最後には仕事を忘れて喘いでいた
		ENDSELECT
	ENDSELECT
ENDIF