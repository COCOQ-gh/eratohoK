;-------------------------------------------------
;シナリオ12
;悪の栄えた試し無し
;-------------------------------------------------
@SCENARIO_NAME_12
RESULTS = 悪の栄えた試し無し
RETURN

@IS_COUNTRY_PLAYABLE_12(ARG:0)
SIF IS_SP_COUNTRY(ARG:0)
	RETURN
RETURN 1

@SCENARIO_INTRO_12
PRINTFORML
PRINTFORMW 幻想郷は分裂した！
PRINTFORMW 熾烈なる勢力争いに乗じて　ワルい奴らが現れ暴虐の限りを尽くした
PRINTFORMW 長きに渡る戦いにより疲弊した幻想少女たちは撤退を　余儀なくされ　多くの都市を奪われてしまった
PRINTFORMW 今こそ団結の時！力を合わせてにっくきアイツらをやっつけろ♥
PRINTFORMW 
PRINTFORMW ◇ちゅうい◇
PRINTFORMW 女の子に乱暴する特殊勢力が必ず出現します
PRINTFORMW そういうの苦手な人は回れ右するか後ほど[設定]からCONFIG:80やCONFIG:200を確認してください
PRINTFORMW 
PRINTL

;ランダムキャラは選択に委ねる
FLAG:4 = 0

@SCENARIO_PLACEMENT_12
#DIM 友好
;勢力設定
COUNTRY_BOSS:0 = 0
COUNTRY_COLOR:0 = GETDEFCOLOR()

;団結すると言ったな。あれは嘘だ
友好 = 500

CALL SCENARIO12_SPC_RANK

;--------霊夢;--------
COUNTRY_BOSS:1 = GET_ID(NAME_TO_CHARA("霊夢"))
COUNTRY_COLOR:1 = 0x757575
COUNTRY_AI_TYPE:1 = AI_外交

CITY_OWNER:GET_CITYNUMBER("博麗神社") = 1
CITY_OWNER:GET_CITYNUMBER("博麗大結界") = 1
;CITY_OWNER:GET_CITYNUMBER("ミズナラの木") = 1
CITY_OWNER:GET_CITYNUMBER("裏手の池") = 1
;神社オールスター
CFLAG:(NAME_TO_CHARA("霊夢")):1 = 1
CFLAG:(NAME_TO_CHARA("萃香")):1 = 1
CFLAG:(NAME_TO_CHARA("華扇")):1 = 1
CFLAG:(NAME_TO_CHARA("針妙丸")):1 = 1
CFLAG:(NAME_TO_CHARA("魅魔")):1 = 1
CFLAG:(NAME_TO_CHARA("る～こと")):1 = 1
CFLAG:(NAME_TO_CHARA("カナ")):1 = 1
CFLAG:(NAME_TO_CHARA("エレン")):1 = 1
CFLAG:(NAME_TO_CHARA("サニーミルク")):1 = 1
CFLAG:(NAME_TO_CHARA("ルナチャイルド")):1 = 1
CFLAG:(NAME_TO_CHARA("スターサファイア")):1 = 1
CFLAG:(NAME_TO_CHARA("クラウンピース")):1 = 1
;宇佐見！
CFLAG:(NAME_TO_CHARA("菫子")):1 = 1
CFLAG:(NAME_TO_CHARA("蓮子")):1 = 1
CFLAG:(NAME_TO_CHARA("マエリベリー")):1 = 1

;--------スカーレットフェアリーズ--------
COUNTRY_BOSS:2 = GET_ID(NAME_TO_CHARA("レミリア"))
COUNTRY_COLOR:2 = 0xFF0000
COUNTRY_AI_TYPE:2 = AI_好戦

CITY_OWNER:GET_CITYNUMBER("霧の湖") = 2
CITY_OWNER:GET_CITYNUMBER("廃洋館") = 2
CITY_OWNER:GET_CITYNUMBER("無名の丘") = 2
;紅魔館組
CFLAG:(NAME_TO_CHARA("レミリア")):1 = 2
CFLAG:(NAME_TO_CHARA("美鈴")):1 = 2
CFLAG:(NAME_TO_CHARA("咲夜")):1 = 2
CFLAG:(NAME_TO_CHARA("小悪魔")):1 = 2
CFLAG:(NAME_TO_CHARA("パチュリー")):1 = 2
CFLAG:(NAME_TO_CHARA("フランドール")):1 = 2
;すばらしいなかまたち
CFLAG:(NAME_TO_CHARA("大妖精")):1 = 2
CFLAG:(NAME_TO_CHARA("チルノ")):1 = 2
CFLAG:(NAME_TO_CHARA("ルーミア")):1 = 2
CFLAG:(NAME_TO_CHARA("リグル")):1 = 2
CFLAG:(NAME_TO_CHARA("ミスティア")):1 = 2
CFLAG:(NAME_TO_CHARA("リリーホワイト")):1 = 2
CFLAG:(NAME_TO_CHARA("リリーブラック")):1 = 2
CFLAG:(NAME_TO_CHARA("レティ")):1 = 2

;--------魔理沙--------
COUNTRY_BOSS:3 = GET_ID(NAME_TO_CHARA("魔理沙"))
COUNTRY_COLOR:3 = 0xE1D200
CITY_OWNER:GET_CITYNUMBER("マーガトロイド館") = 3
CITY_OWNER:GET_CITYNUMBER("霧雨魔法店") = 3
CITY_OWNER:GET_CITYNUMBER("魔法の森南部") = 3
;アリスと人形たち　あと朱鷺子
CFLAG:(NAME_TO_CHARA("霖之助")):1 = 3
CFLAG:(NAME_TO_CHARA("魔理沙")):1 = 3
CFLAG:(NAME_TO_CHARA("アリス")):1 = 3
CFLAG:(NAME_TO_CHARA("上海人形")):1 = 3
CFLAG:(NAME_TO_CHARA("蓬莱人形")):1 = 3
CFLAG:(NAME_TO_CHARA("大江戸人形")):1 = 3
CFLAG:(NAME_TO_CHARA("ゴリアテ人形")):1 = 3
CFLAG:(NAME_TO_CHARA("朱鷺子")):1 = 3

;--------ひとざとをまもるよ--------
COUNTRY_BOSS:4 = GET_ID(NAME_TO_CHARA("白蓮"))
COUNTRY_COLOR:4 = 0xDF01D7
COUNTRY_AI_TYPE:4 = AI_外交

CITY_OWNER:GET_CITYNUMBER("命蓮寺") = 4
CITY_OWNER:GET_CITYNUMBER("墓地") = 4
CITY_OWNER:GET_CITYNUMBER("阿求屋敷") = 4
CITY_OWNER:GET_CITYNUMBER("人里住宅街") = 4
;響子と小傘含む寺
CFLAG:(NAME_TO_CHARA("響子")):1 = 4
CFLAG:(NAME_TO_CHARA("ナズーリン")):1 = 4
CFLAG:(NAME_TO_CHARA("小傘")):1 = 4
CFLAG:(NAME_TO_CHARA("一輪")):1 = 4
CFLAG:(NAME_TO_CHARA("雲山")):1 = 4
CFLAG:(NAME_TO_CHARA("水蜜")):1 = 4
CFLAG:(NAME_TO_CHARA("星")):1 = 4
CFLAG:(NAME_TO_CHARA("白蓮")):1 = 4
CFLAG:(NAME_TO_CHARA("マミゾウ")):1 = 4
;慧音と妹紅とあきゅこす
CFLAG:(NAME_TO_CHARA("慧音")):1 = 4
CFLAG:(NAME_TO_CHARA("妹紅")):1 = 4
CFLAG:(NAME_TO_CHARA("阿求")):1 = 4
CFLAG:(NAME_TO_CHARA("小鈴")):1 = 4

;--------ゆかゆゆ--------
COUNTRY_BOSS:5 = GET_ID(NAME_TO_CHARA("紫"))
COUNTRY_COLOR:5 = 0x792B90
COUNTRY_AI_TYPE:5 = AI_内政

CITY_OWNER:GET_CITYNUMBER("八雲屋敷") = 5
CITY_OWNER:GET_CITYNUMBER("マヨヒガ") = 5
CITY_OWNER:GET_CITYNUMBER("七千階段") = 5
;八雲家
CFLAG:(NAME_TO_CHARA("紫")):1 = 5
CFLAG:(NAME_TO_CHARA("藍")):1 = 5
CFLAG:(NAME_TO_CHARA("橙")):1 = 5
CFLAG:(NAME_TO_CHARA("妖忌")):1 = 5
CFLAG:(NAME_TO_CHARA("幽々子")):1 = 5
CFLAG:(NAME_TO_CHARA("リリカ")):1 = 5
CFLAG:(NAME_TO_CHARA("メルラン")):1 = 5
CFLAG:(NAME_TO_CHARA("ルナサ")):1 = 5
CFLAG:(NAME_TO_CHARA("妖夢")):1 = 5
CFLAG:(NAME_TO_CHARA("半霊")):1 = 5

;--------月……--------
COUNTRY_BOSS:6 = GET_ID(NAME_TO_CHARA("永琳"))
COUNTRY_COLOR:6 = 0x778CFF
COUNTRY_AI_TYPE:6 = AI_防衛

CITY_OWNER:GET_CITYNUMBER("永遠亭") = 6
CITY_OWNER:GET_CITYNUMBER("素兎の集落") = 6
CITY_OWNER:GET_CITYNUMBER("迷いの竹林西部") = 6

;永遠亭組
CFLAG:(NAME_TO_CHARA("永琳")):1 = 6
CFLAG:(NAME_TO_CHARA("てゐ")):1 = 6
CFLAG:(NAME_TO_CHARA("鈴仙")):1 = 6
CFLAG:(NAME_TO_CHARA("輝夜")):1 = 6

;月組
CFLAG:(NAME_TO_CHARA("依姫")):1 = 6
CFLAG:(NAME_TO_CHARA("豊姫")):1 = 6
CFLAG:(NAME_TO_CHARA("レイセン")):1 = 6
CFLAG:(NAME_TO_CHARA("鈴瑚")):1 = 6
CFLAG:(NAME_TO_CHARA("清蘭")):1 = 6
CFLAG:(NAME_TO_CHARA("サグメ")):1 = 6
CFLAG:(NAME_TO_CHARA("月の門番")):1 = 6


;--------新地獄連合--------
COUNTRY_BOSS:7 = GET_ID(NAME_TO_CHARA("四季映姫"))
COUNTRY_COLOR:7 = 0x088A08
CITY_OWNER:GET_CITYNUMBER("三途の川") = 7
CITY_OWNER:GET_CITYNUMBER("中有の道") = 7
CITY_OWNER:GET_CITYNUMBER("渡し舟処") = 7

CFLAG:(NAME_TO_CHARA("純狐")):1 = 7
CFLAG:(NAME_TO_CHARA("ヘカーティア")):1 = 7
;ヅカ組
CFLAG:(NAME_TO_CHARA("四季映姫")):1 = 7
CFLAG:(NAME_TO_CHARA("メディスン")):1 = 7
CFLAG:(NAME_TO_CHARA("幽香")):1 = 7
CFLAG:(NAME_TO_CHARA("小町")):1 = 7

;--------旧地獄連合--------
COUNTRY_BOSS:10 = GET_ID(NAME_TO_CHARA("さとり"))
COUNTRY_COLOR:10 = 0xFA5882
COUNTRY_AI_TYPE:10 = AI_防衛

CITY_OWNER:GET_CITYNUMBER("地霊殿") = 10
CITY_OWNER:GET_CITYNUMBER("灼熱地獄跡") = 10
CITY_OWNER:GET_CITYNUMBER("旧地獄街道") = 10

;地霊殿組
CFLAG:(NAME_TO_CHARA("さとり")):1 = 10
CFLAG:(NAME_TO_CHARA("燐")):1 = 10
CFLAG:(NAME_TO_CHARA("空")):1 = 10
CFLAG:(NAME_TO_CHARA("こいし")):1 = 10
;旧地獄
CFLAG:(NAME_TO_CHARA("キスメ")):1 = 10
CFLAG:(NAME_TO_CHARA("ヤマメ")):1 = 10
CFLAG:(NAME_TO_CHARA("パルスィ")):1 = 10
CFLAG:(NAME_TO_CHARA("勇儀")):1 = 10

;--------妖怪の山連合--------
COUNTRY_BOSS:8 = GET_ID(NAME_TO_CHARA("神奈子"))
COUNTRY_COLOR:8 = 0x79FF4B
COUNTRY_AI_TYPE:8 = AI_好戦

CITY_OWNER:GET_CITYNUMBER("守矢神社") = 8
CITY_OWNER:GET_CITYNUMBER("間欠泉地下センター") = 8
;CITY_OWNER:GET_CITYNUMBER("妖怪の山山頂") = 8
;CITY_OWNER:GET_CITYNUMBER("風神の湖") = 8
CITY_OWNER:GET_CITYNUMBER("大蝦蟇の池") = 8
;やまんちゅ
CFLAG:(NAME_TO_CHARA("静葉")):1 = 8
CFLAG:(NAME_TO_CHARA("穣子")):1 = 8
CFLAG:(NAME_TO_CHARA("雛")):1 = 8
CFLAG:(NAME_TO_CHARA("にとり")):1 = 8
CFLAG:(NAME_TO_CHARA("椛")):1 = 8
CFLAG:(NAME_TO_CHARA("文")):1 = 8
CFLAG:(NAME_TO_CHARA("はたて")):1 = 8
CFLAG:(NAME_TO_CHARA("早苗")):1 = 8
CFLAG:(NAME_TO_CHARA("諏訪子")):1 = 8
CFLAG:(NAME_TO_CHARA("神奈子")):1 = 8

;--------神子--------
COUNTRY_BOSS:9 = GET_ID(NAME_TO_CHARA("神子"))
COUNTRY_COLOR:9 = 0xFF8000
COUNTRY_AI_TYPE:9 = AI_外交

CITY_OWNER:GET_CITYNUMBER("夢殿大祀廟") = 9
CITY_OWNER:GET_CITYNUMBER("神霊廟") = 9
CITY_OWNER:GET_CITYNUMBER("幻夢界") = 9
;廟＋こころ
CFLAG:(NAME_TO_CHARA("神子")):1 = 9
CFLAG:(NAME_TO_CHARA("芳香")):1 = 9
CFLAG:(NAME_TO_CHARA("青娥")):1 = 9
CFLAG:(NAME_TO_CHARA("布都")):1 = 9
CFLAG:(NAME_TO_CHARA("屠自古")):1 = 9
CFLAG:(NAME_TO_CHARA("こころ")):1 = 9

;--------天子--------
COUNTRY_BOSS:11 = GET_ID(NAME_TO_CHARA("天子"))
COUNTRY_COLOR:11 = 0x002FFF
COUNTRY_AI_TYPE:11 = AI_好戦
;天子衣玖
CFLAG:(NAME_TO_CHARA("天子")):1 = 11
CFLAG:(NAME_TO_CHARA("衣玖")):1 = 11
CITY_OWNER:GET_CITYNUMBER("桃園") = 11
CITY_OWNER:GET_CITYNUMBER("有頂天") = 11
CITY_OWNER:GET_CITYNUMBER("竜宮の遣い専用宿舎") = 11
CITY_OWNER:GET_CITYNUMBER("比那名居家総領娘屋敷") = 11


CALL BANDIT_INIT()
LOCAL = RESULT
CITY_OWNER:GET_CITYNUMBER("旧都温泉街") = LOCAL
CITY_OWNER:GET_CITYNUMBER("旧都歓楽街") = LOCAL
CITY_OWNER:GET_CITYNUMBER("渡る者の途絶えた橋") = LOCAL
CITY_OWNER:GET_CITYNUMBER("玄武の沢") = LOCAL
CITY_OWNER:GET_CITYNUMBER("魔法の森北部") = LOCAL
CITY_OWNER:GET_CITYNUMBER("魔法の森西部") = LOCAL
CITY_OWNER:GET_CITYNUMBER("妖怪の山麓") = LOCAL
CITY_OWNER:GET_CITYNUMBER("妖怪の山樹海") = LOCAL
SP_COUNTRY_APPEARED:特殊勢力_野盗 = 1

CALL GAIRAI_INIT()
LOCAL = RESULT
CITY_OWNER:GET_CITYNUMBER("裏山の道") = LOCAL
CITY_OWNER:GET_CITYNUMBER("ミズナラの木") = LOCAL
CITY_OWNER:GET_CITYNUMBER("裏山の湖") = LOCAL
CITY_OWNER:GET_CITYNUMBER("忘れ去られた道") = LOCAL
CITY_OWNER:GET_CITYNUMBER("夢幻館") = LOCAL
CITY_OWNER:GET_CITYNUMBER("八目鰻の屋台") = LOCAL
CITY_OWNER:GET_CITYNUMBER("夢幻門") = LOCAL
CITY_OWNER:GET_CITYNUMBER("夢幻界") = LOCAL
SP_COUNTRY_APPEARED:特殊勢力_外来人 = 1

CALL GOBLIN_INIT()
LOCAL = RESULT
CITY_OWNER:GET_CITYNUMBER("紅魔館") = LOCAL
CITY_OWNER:GET_CITYNUMBER("妖精の森") = LOCAL
CITY_OWNER:GET_CITYNUMBER("地下図書館") = LOCAL
CITY_OWNER:GET_CITYNUMBER("人間の里の畑") = LOCAL
CITY_OWNER:GET_CITYNUMBER("霧雨店") = LOCAL
CITY_OWNER:GET_CITYNUMBER("寺子屋") = LOCAL
CITY_OWNER:GET_CITYNUMBER("迷いの竹林東部") = LOCAL
CITY_OWNER:GET_CITYNUMBER("薬屋道") = LOCAL
SP_COUNTRY_APPEARED:特殊勢力_ホフゴブリン = 1

CALL TENTACLE_INIT()
LOCAL = RESULT
CITY_OWNER:GET_CITYNUMBER("彼岸") = LOCAL
CITY_OWNER:GET_CITYNUMBER("最果て") = LOCAL
CITY_OWNER:GET_CITYNUMBER("幽霊待機場所") = LOCAL
CITY_OWNER:GET_CITYNUMBER("魔界旅行会社") = LOCAL
CITY_OWNER:GET_CITYNUMBER("魔界庁") = LOCAL
CITY_OWNER:GET_CITYNUMBER("白玉楼") = LOCAL
CITY_OWNER:GET_CITYNUMBER("魔界大都会") = LOCAL
CITY_OWNER:GET_CITYNUMBER("是非曲直庁") = LOCAL
CITY_OWNER:GET_CITYNUMBER("西行妖") = LOCAL
SP_COUNTRY_APPEARED:特殊勢力_触手 = 1

CALL SUCCUBUS_INIT()
LOCAL = RESULT
CITY_OWNER:GET_CITYNUMBER("静かな海") = LOCAL
CITY_OWNER:GET_CITYNUMBER("桃源郷") = LOCAL
CITY_OWNER:GET_CITYNUMBER("鳥船遺跡") = LOCAL
CITY_OWNER:GET_CITYNUMBER("豊かな海") = LOCAL
CITY_OWNER:GET_CITYNUMBER("天人の都") = LOCAL
CITY_OWNER:GET_CITYNUMBER("表の月面") = LOCAL
CITY_OWNER:GET_CITYNUMBER("風神の湖") = LOCAL
CITY_OWNER:GET_CITYNUMBER("夢世界") = LOCAL
SP_COUNTRY_APPEARED:特殊勢力_サキュバス = 1

;指定されなかったキャラは放浪 あと「あなた」も（MASTER入れ替えたときに放浪するのを防ぐ）。
FOR LOCAL:0, 1, CHARANUM
	SIF CFLAG:(LOCAL:0):1 == 0 && CSTR:(LOCAL:0):99 != "あなた"
		CFLAG:(LOCAL:0):12 = 1
NEXT

;兵力の初期配置
CALL INIT_ARMY

;無所属都市の兵数は経済の7.5%
FOR LOCAL:0, 0, MAX_CITY
	SIF CITY_OWNER:(LOCAL:0) == 0
		CITY_SOLDIER:(LOCAL:0) = CITY_ECONOMY:(LOCAL:0) * 75 / 1000
NEXT

;■関係設定
CALL SHARED_SETTING_RELATION

FOR LOCAL:1, 0, 11
	FOR LOCAL:2, 0, 11
		IF LOCAL:1 == LOCAL:2
		ELSE
			CALL CHANGE_RELATION_C_TO_C(LOCAL:1, LOCAL:2, 800, 0)
		ENDIF
	NEXT
NEXT


CALL INIT_RELATION("霊夢", "レミリア", 友好, 0)
CALL INIT_RELATION("霊夢", "魔理沙", 友好, 0)
CALL INIT_RELATION("霊夢", "白蓮", 友好, 0)
CALL INIT_RELATION("霊夢", "紫", 友好, 0)
CALL INIT_RELATION("霊夢", "永琳", 友好, 0)
CALL INIT_RELATION("霊夢", "四季映姫", 友好, 0)
CALL INIT_RELATION("霊夢", "神奈子", 友好, 0)
CALL INIT_RELATION("霊夢", "神子", 友好, 0)
CALL INIT_RELATION("霊夢", "さとり", 友好, 0)
CALL INIT_RELATION("霊夢", "天子", 友好, 0)


CALL INIT_RELATION("レミリア", "霊夢", 友好, 0)
CALL INIT_RELATION("レミリア", "魔理沙", 友好, 0)
CALL INIT_RELATION("レミリア", "白蓮", 友好, 0)
CALL INIT_RELATION("レミリア", "紫", 友好, 0)
CALL INIT_RELATION("レミリア", "永琳", 友好, 0)
CALL INIT_RELATION("レミリア", "四季映姫", 友好, 0)
CALL INIT_RELATION("レミリア", "神奈子", 友好, 0)
CALL INIT_RELATION("レミリア", "神子", 友好, 0)
CALL INIT_RELATION("レミリア", "さとり", 友好, 0)
CALL INIT_RELATION("レミリア", "天子", 友好, 0)

CALL INIT_RELATION("魔理沙", "霊夢", 友好, 0)
CALL INIT_RELATION("魔理沙", "レミリア", 友好, 0)
CALL INIT_RELATION("魔理沙", "白蓮", 友好, 0)
CALL INIT_RELATION("魔理沙", "紫", 友好, 0)
CALL INIT_RELATION("魔理沙", "永琳", 友好, 0)
CALL INIT_RELATION("魔理沙", "四季映姫", 友好, 0)
CALL INIT_RELATION("魔理沙", "神奈子", 友好, 0)
CALL INIT_RELATION("魔理沙", "神子", 友好, 0)
CALL INIT_RELATION("魔理沙", "さとり", 友好, 0)
CALL INIT_RELATION("魔理沙", "天子", 友好, 0)

CALL INIT_RELATION("白蓮", "霊夢", 友好, 0)
CALL INIT_RELATION("白蓮", "レミリア", 友好, 0)
CALL INIT_RELATION("白蓮", "魔理沙", 友好, 0)
CALL INIT_RELATION("白蓮", "紫", 友好, 0)
CALL INIT_RELATION("白蓮", "永琳", 友好, 0)
CALL INIT_RELATION("白蓮", "四季映姫", 友好, 0)
CALL INIT_RELATION("白蓮", "神奈子", 友好, 0)
CALL INIT_RELATION("白蓮", "神子", 友好, 0)
CALL INIT_RELATION("白蓮", "さとり", 友好, 0)
CALL INIT_RELATION("白蓮", "天子", 友好, 0)

CALL INIT_RELATION("紫", "霊夢", 友好, 0)
CALL INIT_RELATION("紫", "レミリア", 友好, 0)
CALL INIT_RELATION("紫", "魔理沙", 友好, 0)
CALL INIT_RELATION("紫", "白蓮", 友好, 0)
CALL INIT_RELATION("紫", "永琳", 友好, 0)
CALL INIT_RELATION("紫", "四季映姫", 友好, 0)
CALL INIT_RELATION("紫", "神奈子", 友好, 0)
CALL INIT_RELATION("紫", "神子", 友好, 0)
CALL INIT_RELATION("紫", "さとり", 友好, 0)
CALL INIT_RELATION("紫", "天子", 友好, 0)

CALL INIT_RELATION("永琳", "霊夢", 友好, 0)
CALL INIT_RELATION("永琳", "レミリア", 友好, 0)
CALL INIT_RELATION("永琳", "魔理沙", 友好, 0)
CALL INIT_RELATION("永琳", "白蓮", 友好, 0)
CALL INIT_RELATION("永琳", "紫", 友好, 0)
CALL INIT_RELATION("永琳", "四季映姫", 友好, 0)
CALL INIT_RELATION("永琳", "神奈子", 友好, 0)
CALL INIT_RELATION("永琳", "神子", 友好, 0)
CALL INIT_RELATION("永琳", "さとり", 友好, 0)
CALL INIT_RELATION("永琳", "天子", 友好, 0)

CALL INIT_RELATION("四季映姫", "霊夢", 友好, 0)
CALL INIT_RELATION("四季映姫", "レミリア", 友好, 0)
CALL INIT_RELATION("四季映姫", "魔理沙", 友好, 0)
CALL INIT_RELATION("四季映姫", "白蓮", 友好, 0)
CALL INIT_RELATION("四季映姫", "紫", 友好, 0)
CALL INIT_RELATION("四季映姫", "永琳", 友好, 0)
CALL INIT_RELATION("四季映姫", "神奈子", 友好, 0)
CALL INIT_RELATION("四季映姫", "神子", 友好, 0)
CALL INIT_RELATION("四季映姫", "さとり", 友好, 0)
CALL INIT_RELATION("四季映姫", "天子", 友好, 0)

CALL INIT_RELATION("神奈子", "霊夢", 友好, 0)
CALL INIT_RELATION("神奈子", "レミリア", 友好, 0)
CALL INIT_RELATION("神奈子", "魔理沙", 友好, 0)
CALL INIT_RELATION("神奈子", "白蓮", 友好, 0)
CALL INIT_RELATION("神奈子", "紫", 友好, 0)
CALL INIT_RELATION("神奈子", "永琳", 友好, 0)
CALL INIT_RELATION("神奈子", "四季映姫", 友好, 0)
CALL INIT_RELATION("神奈子", "神子", 友好, 0)
CALL INIT_RELATION("神奈子", "さとり", 友好, 0)
CALL INIT_RELATION("神奈子", "天子", 友好, 0)

CALL INIT_RELATION("神子", "霊夢", 友好, 0)
CALL INIT_RELATION("神子", "レミリア", 友好, 0)
CALL INIT_RELATION("神子", "魔理沙", 友好, 0)
CALL INIT_RELATION("神子", "白蓮", 友好, 0)
CALL INIT_RELATION("神子", "紫", 友好, 0)
CALL INIT_RELATION("神子", "永琳", 友好, 0)
CALL INIT_RELATION("神子", "四季映姫", 友好, 0)
CALL INIT_RELATION("神子", "神奈子", 友好, 0)
CALL INIT_RELATION("神子", "さとり", 友好, 0)
CALL INIT_RELATION("神子", "天子", 友好, 0)

CALL INIT_RELATION("さとり", "霊夢", 友好, 0)
CALL INIT_RELATION("さとり", "レミリア", 友好, 0)
CALL INIT_RELATION("さとり", "魔理沙", 友好, 0)
CALL INIT_RELATION("さとり", "白蓮", 友好, 0)
CALL INIT_RELATION("さとり", "紫", 友好, 0)
CALL INIT_RELATION("さとり", "永琳", 友好, 0)
CALL INIT_RELATION("さとり", "四季映姫", 友好, 0)
CALL INIT_RELATION("さとり", "神奈子", 友好, 0)
CALL INIT_RELATION("さとり", "神子", 友好, 0)
CALL INIT_RELATION("さとり", "天子", 友好, 0)

CALL INIT_RELATION("天子", "霊夢", 友好, 0)
CALL INIT_RELATION("天子", "レミリア", 友好, 0)
CALL INIT_RELATION("天子", "魔理沙", 友好, 0)
CALL INIT_RELATION("天子", "白蓮", 友好, 0)
CALL INIT_RELATION("天子", "紫", 友好, 0)
CALL INIT_RELATION("天子", "永琳", 友好, 0)
CALL INIT_RELATION("天子", "四季映姫", 友好, 0)
CALL INIT_RELATION("天子", "神奈子", 友好, 0)
CALL INIT_RELATION("天子", "神子", 友好, 0)
CALL INIT_RELATION("天子", "さとり", 友好, 0)

;-------------------------------------------------
;定例イベント
;ターンエンド時に呼び出される
;SCVAR:0 外来人侵攻済みフラグ
;SCVAR:1 封獣ぬえ離反済みフラグ
;SCVAR:2 謎の薬売り前回どれだったフラグ
;-------------------------------------------------
@SCENARIO_EVENT_12
#DIM UNIFY

;封獣ぬえ・鬼人正邪離反イベント（それぞれ１回独立します）
;30期以降、封獣ぬえか鬼人正邪がプレイヤーでなく捕虜や放浪状態や死亡状態や外来勢力所属でもなく、かつその所属勢力が5つ以上の都市を得ているとき
LOCAL:1 = 0
;正邪優先、ただし君主が針妙丸の時は起こらない
IF !GETBIT(SCVAR:1,0) && REBELLION_FLAG("正邪", 30) && CFLAG:(NAME_TO_CHARA("正邪")):1 != GET_COUNTRY_FROM_ID(SP_COUNTRY_ID:(特殊勢力_外来人)) && GET_COUNTRY_BOSS(CFLAG:(NAME_TO_CHARA("正邪")):1) != FINDCHARA(CSTR:99, "針妙丸")
	LOCAL:1 = FINDCHARA(CSTR:99, "正邪")
ELSEIF !GETBIT(SCVAR:1,1) && REBELLION_FLAG("ぬえ", 30) && CFLAG:(NAME_TO_CHARA("ぬえ")):1 != GET_COUNTRY_FROM_ID(SP_COUNTRY_ID:(特殊勢力_外来人))
	LOCAL:1 = FINDCHARA(CSTR:99, "ぬえ")
ENDIF
IF LOCAL:1 != 0
	;離反元君主のキャラ番号
	LOCAL:2 = GET_COUNTRY_BOSS(CFLAG:(LOCAL:1):1)
	;離反元国家の番号
	LOCAL:3 = CFLAG:(LOCAL:1):1
	;新しい勢力を取得
	LOCAL:4 = GET_NEW_COUNTRY()
	;反乱フラグをビット処理。これで同一周回でふたりとも謀反できるよ、やったね
	;本命は当然反乱予定者を増やすためにございます（とは言っても64人が限界ですが。TWのビット処理を引用すると汎用でない全キャラ巻き込めますが）
	;勢力発生後に移動させたのは反乱かやらごとの一部設定をここで設定しやすいように。具体的には勢力カラーとか（イメージに合う色が思いつかないのでそのままにしておく）。
	SELECTCASE LOCAL:1
	CASE FINDCHARA(CSTR:99, "正邪")
		SETBIT SCVAR:1 , 0
		COUNTRY_COLOR:(LOCAL:4) = 0xB40431
	CASE FINDCHARA(CSTR:99, "ぬえ")
		SETBIT SCVAR:1 , 1
		COUNTRY_COLOR:(LOCAL:4) = 0xB40431
	ENDSELECT
	;プレイヤーの態度をLOCAL:10に格納
	;出力 0:離反について出奔,1:元君主のもとに留まる,2:説得を行うも失敗
	LOCAL:10 = 1
	;プレイヤーが離反者の所属国家の君主でなく、かつ離反者の同僚である
	IF LOCAL:2 != MASTER && CFLAG:MASTER:1 == CFLAG:(LOCAL:1):1
		;それなりに仲が良いと、一緒に来ないかと尋ねられる
		;正邪用のセリフは用意してません。共通です。一応正体不明云々はぬえの時だけ表示されるはず
		IF CFLAG:(LOCAL:1):2 >= 300
			DRAWLINE
			PRINTFORMW ある日、%ANAME(LOCAL:1)%に急に呼び出された
			PRINTFORMW 人払いをした彼女の部屋で、%ANAME(LOCAL:1)%に告げられる
			PRINTFORMW 「じつはさぁ……%ANAME(LOCAL:2)%のとこを出ようと思うんだよね」
			PRINTFORMW 「つまり離反ってやつ。で、あんた見たところ使えそうだし、なんならウチに来ない？　って相談なんだけど。どう？」
			PRINTFORMW 「迷うと思うんだけど、できればすぐ返事が欲しいんだよね……アンタが%ANAME(LOCAL:2)%にチクらないとも限らないし」
			PRINTFORMW すぐに返事しろと言われても困る。だが%ANAME(LOCAL:1)%は、ともかく何かしら応えるまで返すつもりはないようだ……
			$INPUT_LOOP_NUE_INVITATION
			PRINTFORML [0] %ANAME(LOCAL:1)%につく
			PRINTFORML [1] %ANAME(LOCAL:2)%側に残る
			PRINTFORML [2] バカなことはやめろという
			INPUT
			IF RESULT == 0
				CFLAG:MASTER:1 = LOCAL:4
				PRINTFORMW 「くくっ、あんたならそう言ってくれると思ってたよ」
				PRINTFORMW %ANAME(LOCAL:1)%は凶悪な笑みをにやりと浮かべてみせた。
				PRINTFORMW 「じゃあ、いっちょやってやろうじゃないか。私とあんたで、この幻想郷を恐怖の底に沈めてやるのさ」
				IF LOCAL:1 == NAME_TO_CHARA("ぬえ")
					PRINTFORMW 「……正体不明の恐怖にね！　くくく！」
				ENDIF
				PRINTFORMW なんだかえらいことに首を突っ込んでしまった気がする。大丈夫だろうか……。
				;ぬえちゃん強キャラだけどぶっちゃけ他に誰連れてこれるか次第だねこれね。
				;チート級あなたが味方ならそりゃまぁ心強いけど、途中何回孕まされるか分かったもんじゃないね？？
				LOCAL:10 = 0
			ELSEIF RESULT == 1
				PRINTFORMW %ANAME(LOCAL:2)%を裏切るわけにはいかない……そう告げると、%ANAME(LOCAL:1)%は露骨に失望した表情を浮かべた
				PRINTFORMW 「……はあ。あっそ、じゃあとっとと出ていきな」
				PRINTFORMW 「後悔しないことだね。私の国は、あんたんとこなんて一瞬で食い尽くすよ」
				PRINTFORMW それっきり%ANAME(LOCAL:1)%はこちらに興味を失ったのか、そっぽを向いてしまった
				PRINTFORMW ここで%ANAME(MASTER)%に危害を加えるつもりはないようだが、次に会うときは敵としてになるだろう……
				PRINTL
				LOCAL:10 = 1
			ELSEIF RESULT == 2 && (IS_LOVER(LOCAL:1) || IS_SLAVE(LOCAL:1))
				PRINTFORMW バカなことはやめろ……%ANAME(MASTER)%が必死に説得すると、%ANAME(LOCAL:1)%はため息をついた
				PRINTFORMW 「……はあ。あんたにそんなこと言われちゃうなんてね」
				PRINTFORMW 「まあ、分かったよ。あんたの言うことは断りたくないから。我慢してあげる：
				PRINTFORMW 「……その代わり、私のこと、色々満足させてよね？」
				PRINTFORMW どうやら%ANAME(LOCAL:1)%は離反をあきらめてくれたようだ……
				RETURN
			ELSEIF RESULT == 2
				PRINTFORMW バカなことはやめろ……%ANAME(MASTER)%が必死に説得すると、%ANAME(LOCAL:1)%は逆上した
				PRINTFORMW 「あ？　なんであんたにそんなこと言われなきゃいけないわけ？」
				PRINTFORMW 「もういい。分かった。あんたは要らない。私が作る新しい国に、呑まれて消えちまえばいいんだ
				PRINTFORMW それっきり%ANAME(LOCAL:1)%はこちらに興味を失ったのか、そっぽを向いてしまった
				PRINTFORMW ここで%ANAME(MASTER)%に危害を加えるつもりはないようだが、次に会うときは敵としてになるだろう……
				LOCAL:10 = 2
			ENDIF
		ENDIF
	ENDIF
	DRAWLINE

	SETCOLOR COLOR("注意")
	PRINTFORMW ！%NAME_FORMAL(LOCAL:1)%が挙兵し、%NAME_FORMAL(LOCAL:2)%の勢力から独立しました！
	RESETCOLOR
	WAIT
	
	COUNTRY_BOSS:(LOCAL:4) = GET_ID(LOCAL:1)
	CFLAG:(LOCAL:1):1 = LOCAL:4

	;離反元勢力の都市の守将を解除
	FOR LOCAL:0, 0, MAX_CITY
		IF CITY_OWNER:(LOCAL:0) == LOCAL:3
			CITY_COMMANDER:(LOCAL:0) = 0
		ENDIF
	NEXT

	;DEBUGPRINTFORML DISARM:{LOCAL:3}

	;都市を二つかすめ取る
	;隣接する二都市を確実に奪うように。なお離反元が分断されても致し方なし
	;隣接前提で三都市以上となると判定が面倒なのでやめておくといいと思います。
	;LOCAL 3:離反元の勢力 , 4:離反勢力 , 6:仮の離反都市A , 7:仮の離反都市B , 8:離反都市確定フラグ
	LOCAL:8 = 0
	CALL FISHER_YATES_SHAFFLE(MAX_CITY)
	FOR LOCAL:5, 0, MAX_CITY
		LOCAL:0 = SHAFFLE_ARRAY:(LOCAL:5)
		;都市が離反元勢力のものか
		IF CITY_OWNER:(LOCAL:0) == LOCAL:3
			;仮の離反都市Aの設定
			LOCAL:6 = LOCAL:5
			;残りの都市から隣接している離反元勢力の都市を検索
			FOR LOCAL:7 , LOCAL:6 , MAX_CITY
				;離反元勢力かつ接続している
				IF CITY_OWNER:(LOCAL:7) == LOCAL:3 && IS_ROOT(LOCAL:0 , LOCAL:7)
					;二都市の勢力を離反勢力のものに変えフラグを立てる
					CALL TAKEOVER_CITY_FROM_NO(LOCAL:4, LOCAL:0)
					CALL TAKEOVER_CITY_FROM_NO(LOCAL:4, LOCAL:7)
					LOCAL:8 = 1
					BREAK
				ENDIF
			NEXT
		ENDIF
		SIF LOCAL:8
			BREAK
	NEXT
	;離反元勢力の全都市が孤立していた場合、ランダムに二都市奪う
	IF !LOCAL:8
		LOCAL:6 = 0
		CALL STEAL_CITIES(LOCAL:3, LOCAL:4, 2)
		;DEBUGPRINTFORML KEEP CITY:RANDAM
	ELSE
		;DEBUGPRINTFORML KEEP CITY:CONNECT
	ENDIF


	;マミゾウは（ぬえの離反の時、離反元にいて、捕虜でなく、君主でもなければ）必ず奪う
	IF CFLAG:(NAME_TO_CHARA("マミゾウ")):1 == LOCAL:3 && CFLAG:(NAME_TO_CHARA("マミゾウ")):9 == 0 && LOCAL:2 != NAME_TO_CHARA("マミゾウ") && LOCAL:1 == NAME_TO_CHARA("ぬえ")
		CFLAG:(NAME_TO_CHARA("マミゾウ")):1 = LOCAL:4
	ENDIF


	;離反元所属武将の一部をかすめ取る処理。
	;LOCAL 1:離反者 , 2:離反元勢力君主 , 3:離反元勢力 , 5:離反元の未陥落者数 , 6:離反元の陥落済人数（プレイヤーが離反元勢力にいなければ5に併合）
	;      7:離反元から引きぬく人数 , 10:離反勧誘の返答
	;
	LOCAL:5 = 0
	LOCAL:6 = 0
	;所属武将の数を調べる
	FOR LOCAL:0, 0, CHARANUM
		;離反元所属で、捕虜でなく、プレイヤーでも離反者でも君主でないキャラ
		IF CFLAG:(LOCAL:0):1 == LOCAL:3 && CFLAG:(LOCAL:0):9 == 0 && !GROUPMATCH(LOCAL:0 , MASTER , LOCAL:1 , LOCAL:2)
		;DEBUGPRINTFORML CHARAMATCH:{LOCAL:0}
			;恋慕系か隷属系でないなら組み込み、恋慕なら拉致、プレイヤーのいない勢力では組み込み
			;(陥落済かつ「離反に同調」か「離反せず離反元に残る」)
			IF (IS_LOVER(LOCAL:0) || IS_SLAVE(LOCAL:0)) && (!LOCAL:10 || (LOCAL:10 && CFLAG:MASTER:1 == LOCAL:3))
				LOCAL:6 ++
			ELSE
				LOCAL:5 ++
			ENDIF
		ENDIF
	NEXT
	;DEBUGPRINTFORML PICK :{LOCAL:5}
	;DEBUGPRINTFORML STEAL:{LOCAL:6}


	;引き抜き・拉致対象武将が0より大きいなら、ループ回しながらランダムにもっていく
	;拉致は多くて1/3まで。ただしいずれも候補が一人以上いるなら最低一人は持っていく可能性がある
	IF LOCAL:5 > 0 || LOCAL:6 > 0
		LOCAL:5 = LOCAL:5 ? MAX(LOCAL:5 / 3 , 1) # 0
		;あなたが裏切るなら恋慕・隷属は全員付いてくる
		IF LOCAL:10 == 1
			LOCAL:6 = LOCAL:6 ? MAX(RAND:(LOCAL:6 + 1) / 3 , 1) # 0
		;怒らせると陥落済の人を余分に拉致して行きます。これは後でおしおきですね
		ELSEIF LOCAL:10 == 2
			LOCAL:6 = LOCAL:6 ? MAX(RAND:(LOCAL:6 + 1) * 2 / 3 , 1) # 0
		ENDIF
		;LOCAL:7に引抜き及び拉致する人数を合計しておき、合計人数が75％以上（残選択数が25％以下）であればそこで諦める
		LOCAL:7 = LOCAL:5 + LOCAL:6
		;最大周回を5回に設定
		LOCAL:11 = 5
		WHILE (100 - ((LOCAL:5 + LOCAL:6) * 100 / LOCAL:7) < 75 && LOCAL:11 > 0)
			;判定するキャラ順をシャッフル、再挑戦するたびに順番は変わります
			CALL FISHER_YATES_SHAFFLE(CHARANUM)
			FOR LOCAL:99, 0, CHARANUM
				LOCAL:0 = SHAFFLE_ARRAY:(LOCAL:99)
				;離反元所属で、捕虜でなく、プレイヤーでも離反者でも君主でないキャラ
				IF CFLAG:(LOCAL:0):1 == LOCAL:3 && CFLAG:(LOCAL:0):9 == 0 && !GROUPMATCH(LOCAL:0 , MASTER , LOCAL:1 , LOCAL:2)
					;陥落済かつ「離反に同調」か「離反せず離反元に残る」ではないなら1/2で引き抜かれる
					IF !((IS_LOVER(LOCAL:0) || IS_SLAVE(LOCAL:0)) && (!LOCAL:10 || (LOCAL:10 && CFLAG:MASTER:1 == LOCAL:3))) && RAND:2 == 0  && LOCAL:5 > 0
						CFLAG:(LOCAL:0):1 = LOCAL:4
						LOCAL:5 --
					;離反せず離反元に残るなら陥落済みキャラは1/2で拉致される
					ELSEIF RAND:2 == 0 && (IS_LOVER(LOCAL:0) || IS_SLAVE(LOCAL:0)) && LOCAL:6 > 0 && INRANGE(LOCAL:10 , 1 , 2)
						CFLAG:(LOCAL:0):9 = LOCAL:4
						LOCAL:6 --
					;離反に同調すれば陥落済キャラは同行
					ELSEIF (IS_LOVER(LOCAL:0) || IS_SLAVE(LOCAL:0)) && LOCAL:6 > 0 && LOCAL:10 == 0
						CFLAG:(LOCAL:0):1 = LOCAL:4
						LOCAL:6 --
					ENDIF
				ENDIF
			NEXT
			LOCAL:11 --
		WEND
	ENDIF
	;離反元勢力の部隊を解散
	CALL CLEAR_ALL_UNIT(LOCAL:3, 1)

	;仲はまぁ、悪くもなりますわな
	CALL CHANGE_RELATION_C_TO_C(LOCAL:3, LOCAL:4, -200, 600)
	CALL CHANGE_RELATION_C_TO_C(LOCAL:4, LOCAL:3, -200, 600)
	
	;反乱勢力の都市を表示
	FOR LOCAL:0, 0, MAX_CITY
		IF CITY_OWNER:(LOCAL:0) == LOCAL:4
			PRINTFORML %GET_CITYNAME(LOCAL:0)%が%ANAME(LOCAL:1)%の支配下におかれました
		ENDIF
	NEXT
	;反乱勢力に流れた人材
	FOR LOCAL:0, 0, CHARANUM
		IF CFLAG:(LOCAL:0):1 == LOCAL:4 && LOCAL:0 != LOCAL:1
			PRINTFORML %ANAME(LOCAL:0)%が%ANAME(LOCAL:1)%の下につきました
		ELSEIF CFLAG:(LOCAL:0):9 == LOCAL:4
			SETCOLOR COLOR("注意")
			;性処理用云々は消しました
			PRINTFORML %ANAME(LOCAL:0)%が%ANAME(LOCAL:1)%に拉致されました
			RESETCOLOR
		ENDIF
	NEXT
ENDIF

@SCENARIO12_SPC_RANK()
#DIM FIRST_LINE
#DIM 勢力

PRINTFORML シナリオに登場する「特殊な」勢力の強さを選んで下さい
PRINTFORML 各勢力、小さい数字ほど弱く、大きい数字ほど強くなります
PRINTFORML

FOR LOCAL, 0, MAX_SP_COUNTRY
	IF SP_COUNTRY_NAME:LOCAL != ""
		SP_COUNTRY_RANK:LOCAL = 1
	ENDIF
NEXT
FIRST_LINE = LINECOUNT
$SHOW_LOOP

PRINTFORML 野盗\@ GET_NEW_COUNTRY() == -1 ? （勢力が一杯であるため、出現できません） # \@
CALL PRINTBUTTON_EX("{1}", 11, 1, SP_COUNTRY_RANK:(特殊勢力_野盗) == 1)
CALL PRINTBUTTON_EX("{2}", 12, 1, SP_COUNTRY_RANK:(特殊勢力_野盗) == 2)
CALL PRINTBUTTON_EX("{3}", 13, 1, SP_COUNTRY_RANK:(特殊勢力_野盗) == 3)
CALL PRINTBUTTON_EX("{4}", 14, 1, SP_COUNTRY_RANK:(特殊勢力_野盗) == 4)
CALL PRINTBUTTON_EX("{5}", 15, 1, SP_COUNTRY_RANK:(特殊勢力_野盗) == 5)
PRINTL

FOR LOCAL, 2, MAX_SP_COUNTRY
	LOCALS = %SP_COUNTRY_NAME:LOCAL%
	PRINTFORML %LOCALS%
	CALL PRINTBUTTON_EX("{1}", 10 * LOCAL + 1, 1, SP_COUNTRY_RANK:LOCAL == 1)
	CALL PRINTBUTTON_EX("{2}", 10 * LOCAL + 2, 1, SP_COUNTRY_RANK:LOCAL == 2)
	CALL PRINTBUTTON_EX("{3}", 10 * LOCAL + 3, 1, SP_COUNTRY_RANK:LOCAL == 3)
	CALL PRINTBUTTON_EX("{4}", 10 * LOCAL + 4, 1, SP_COUNTRY_RANK:LOCAL == 4)
	CALL PRINTBUTTON_EX("{5}", 10 * LOCAL + 5, 1, SP_COUNTRY_RANK:LOCAL == 5)
	PRINTL
NEXT

PRINTL
PRINTFORML ボスの名前（ランダム名は男性名です）

FOR LOCAL, 0, MAX_SP_COUNTRY
	LOCALS = %SP_COUNTRY_NAME:LOCAL%
	PRINTFORML %LOCALS%
	CALL PRINTBUTTON_EX(@"[勢力名]", 10 * LOCAL + 100, SP_COUNTRY_RANK:LOCAL, SP_COUNTRY_BOSSNAME:LOCAL == 0)
	CALL PRINTBUTTON_EX(@"[固有名]",   10 * LOCAL + 101, SP_COUNTRY_RANK:LOCAL, SP_COUNTRY_BOSSNAME:LOCAL == 1)
	CALL PRINTBUTTON_EX(@"[ランダム]", 10 * LOCAL + 102, SP_COUNTRY_RANK:LOCAL, SP_COUNTRY_BOSSNAME:LOCAL == 2)
	PRINTL
NEXT
PRINTL
PRINTBUTTON "[これで決定]", 999
$INPUT_LOOP
INPUT
IF RESULT == 999
RETURN
ENDIF

IF INRANGE(RESULT, 0, 99)
	;選択肢
	LOCAL = RESULT % 10
	;勢力
	LOCAL:1 = RESULT / 10
	IF SP_COUNTRY_NAME:(LOCAL:1) != "" && INRANGE(LOCAL, 0, 5)
		SP_COUNTRY_RANK:(LOCAL:1) = LOCAL
	ENDIF
ENDIF

IF INRANGE(RESULT, 100, 199)
	RESULT -= 100
	;選択肢
	LOCAL = RESULT % 10
	;勢力
	LOCAL:1 = RESULT / 10
	IF SP_COUNTRY_NAME:(LOCAL:1) != "" && INRANGE(LOCAL, 0, 2) && SP_COUNTRY_RANK:(LOCAL:1) 
		SP_COUNTRY_BOSSNAME:(LOCAL:1) = LOCAL
	ENDIF
ENDIF
CLEARLINE LINECOUNT - FIRST_LINE
GOTO SHOW_LOOP
