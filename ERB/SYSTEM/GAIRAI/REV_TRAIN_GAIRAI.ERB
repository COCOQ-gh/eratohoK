@REV_TRAIN_GAIRAI
#DIM 候補, 1000
#DIM 候補数
#DIM 参加者, 8
#DIM 参加者数
#DIM 外来
#DIM ループ数
#DIM 対象
VARSET 対象
VARSET 候補, -1
VARSET 候補数
VARSET 参加者, -1
VARSET 参加者数

外来 = GET_COUNTRY_FROM_ID(COUNTRY_GAIRAI)
;ゴブリンによる主人公以外のキャラへの自動調教
IF FLAG:28
	CALL TRAIN_BY_GAIRAI
ENDIF

IF !FLAG:14
	FLAG:14 = 1
	;MASTERが男で、恋人が外来に捕まっている場合、イベント
	IF IS_MALE(MASTER)
		FOR LOCAL, 0, CHARANUM
			IF CFLAG:MASTER:所属 == CFLAG:LOCAL:所属 && CFLAG:LOCAL:捕虜先 == 外来 && TALENT:LOCAL:恋人 && IS_FEMALE(LOCAL)
				対象 = LOCAL
				BREAK
			ENDIF
		NEXT
		IF 対象
			DRAWLINE
			PRINTFORMW 「やぁ！　キミが%ANAME(MASTER)%か！　話は聞いてるよ」
			PRINTFORML 牢屋に閉じ込められた%ANAME(MASTER)%に、痩せぎすの男が話しかけてきた
			PRINTFORMW 白衣を身に着けているあたり、看守ではあるまい。睨みつける
			PRINTFORMW 「おっと、そう怖い顔をしないでくれ。閉じ込めてるのはすまないと思ってる」
			PRINTFORMW 「しょうがないじゃないか、こうしないとキミ、暴れるだろう？」
			PRINTFORMW 「多分、キミは我々の活動に対して誤解を抱いているんだ。我々はキミらに害をなすつもりはない」
			PRINTFORMW 「キミの相方さん……%ANAME(対象)%だっけ？　にも手伝ってもらったけど、傷一つないとも」
			PRINTFORML 信じられるか、%ANAME(対象)%を解放しろ――噛みつくように言い放つが、相手は動じていない
			PRINTFORMW 二人を隔てる鋼鉄の檻を信用しているのだろう。事実、こればかりは破壊しようもなかった
			PRINTFORMW 「あぁうん、そのことだよ。実は%ANAME(対象)%に手伝ってもらった実験が終わってね」
			PRINTFORMW 「特にもう用はないし、解放しようって思うんだ。%ANAME(対象)%がどうしてもっていうんで、キミも一緒にね」
			PRINTFORML 解放？　この男は何を言っているのだろう
			PRINTFORMW こいつらの執念深さについては、噂で聞いている。そんなに簡単に捕虜を解き放つはずがない
			PRINTFORMW 訝る%ANAME(MASTER)%だが、男は気にしていないようだった
			PRINTFORMW 「まぁ信じられないよな。そうだろうなって思うよ。だから連れてきたよ、ほら、おいで」
			PRINTFORML 男が手招きすると、影が近づいてきた
			PRINTFORMW ……%ANAME(対象)%だ！　無事だったのだ！
			PRINTFORMW 怪我もしていないようだ……。%ANAME(MASTER)%は胸をなで下ろす
			PRINTFORMW 「どうだい、ちょっとは信用してくれる気になったかい？」
			PRINTFORML ……確かに、%ANAME(対象)%が無事だというところは嘘ではなかったのだろう
			PRINTFORMW だが、お前たちが非道な実験をしていないということの証明にはならない。早く解放しろ――そう言った
			PRINTFORMW 「うわぁ、ひどい嫌われようだ……うーん、信用を勝ちとるためにも、%ANAME(対象)%に手伝ってもらった実験の説明をしようか」
			PRINTFORMW 「我々のチームのテーマは簡単。『人はいかにして、他者に隷属するのか』」
			PRINTFORMW 「だから%ANAME(対象)%には、隷属してもらった」
			PRINTFORMW 「研究過程で色々なことが分かったよ。ただ痛みを与えるだけでなくそこに脅しの一言があったほうがいいとか」
			PRINTFORMW 「同じレベルの苦痛でも火傷は特に有効、みたいなのもあったね。これは興味深いし、もうちょっと調べることにしよう」
			PRINTFORMW 「どれ、ちょっと結果を見せてあげよう！　……%ANAME(対象)%」
			PRINTFORML 男が%ANAME(対象)%の名を呼ぶ。%ANAME(対象)%はびくりと肩を震わせる。
			PRINTFORMW 見比べるように、%ANAME(MASTER)%と男に交互に目をやった
			PRINTFORMW 「どうした？　僕は彼に研究結果を見せたいんだ。手伝ってくれ。……それとも、『それ以外のこと』をされたいのか？」
			PRINTFORMW それ以外のこと。その一言が出た途端、%ANAME(対象)%の表情が歪む
			PRINTFORML その「何か」から逃れたいと言わんばかりに、彼女は服をはだけ、己の肌を晒していく
			PRINTFORMW ……生まれたままの姿になった彼女の肌には、いくつかのタトゥが、ピアスがつけられていた
			PRINTFORML 「んー、付けてみたはいいけど、こういったものは、実験にはあまり貢献しなかったな」
			PRINTFORMW 「やっぱりもっと身体感覚に訴えかけるものじゃないと駄目みたいだ。痛みとか苦しさとか熱さとか快感とか」
			PRINTFORMW 「ま、駄目だって分かっただけでも、拾い物だけどね」
			PRINTFORMW 男は肩をすくめる。%ANAME(対象)%は何も言わず、ただ突っ立っていた
			PRINTFORMW 「さて、前置きは以上だ。%ANAME(対象)%の隷属ぐあいをお見せするよ。向かいにある檻は見えるかい？」
			PRINTFORMW 向かいにある檻――虚ろな瞳をした男達が、壁に寄りかかっている。瞳には生気がなかった
			PRINTFORMW 「君にはすまないと思ってるよ、あの檻、なんか不吉だもんな。その向かいで過ごすのは落ち着かなかったろ？」
			PRINTFORMW 「それはさておき……%ANAME(対象)%。あれに抱かれてこい」
			PRINTFORML 男の言ったことは、常軌を逸していた。しかし、より信じられなかったのは、%ANAME(対象)%が頷いたことだった
			PRINTFORMW 何をしているんだ、やめろ――鉄格子にかじりつくようにして叫ぶが、檻へと向かう%ANAME(対象)%の歩みは止まらない
			PRINTFORMW 「心配無用。あれも実験の産物だ。我々に隷属してる――失敗作なんで『壊れてる』けど、不利益になることはしない」
			PRINTFORMW 「それとも、%ANAME(対象)%の身体を心配してるのかな？　それも心配ご無用、ほら、聞いてみるといい」
			PRINTFORML 男は剥き出しにされた%ANAME(対象)%の秘唇へ、当然のように手を伸ばす。%ANAME(対象)%も、拒否せず、自ら脚を開き指を受け入れる
			PRINTFORMW くちゃり、くちゅりと、水に濡れた肉をこねる音が、廊下に響いた
			PRINTFORMW 「分かったかい？　%ANAME(対象)%は発情しているんだ、これから起こることを想像してね」
			PRINTFORMW 「これだけ濡れていれば、ペニスを挿入する摩擦による苦痛なんて考えなくていいだろう」
			PRINTFORMW 「これはまぁ、実験の副産物かな。定期的に快楽を与えた結果だね」
			PRINTFORMW そう言っている間にも、%ANAME(対象)%は歩みを進め、向かい側の檻へと自ら入っていってしまう
			PRINTFORML 檻の中の男達は、生気の無い瞳のままのっそりと起き上がり、のろのろと%ANAME(対象)%の下に群がり、のったりと組み敷く
			PRINTFORMW まるで、「入ってきた女を犯せ」とあらかじめ命じられていた、人形のようだった
			PRINTFORMW そんなものの相手をさせられるというのに、%ANAME(対象)%は抵抗一つしない
			PRINTFORMW 「最初はこれも嫌がったものさ。だから一旦、苦痛を与える方針に切り替えた。これがよかったよ」
			PRINTFORMW 「眠らせないっていうのが特に効いたね。常時爆音を聞かせ続け、それでもまぶたが下りたら水をぶっかける。これだけ」
			PRINTFORMW 「シンプルだけど、睡眠は生物の生命維持に欠かせないからね。費用対効果は非常に高かった」
			PRINTFORMW 「あとは電撃とか――まぁ、しばらくそういうのを続けてたら、こっちも嫌がらなくなったんだ」
			PRINTFORML 男は楽しげに説明する。――楽しげといっても、そこに嗜虐の色は一切なかった
			PRINTFORMW 五歳児や六歳児が、自分の発見を楽しげに語るときの、そういう声色だった
			PRINTFORML そうしているうちにも、人形のような男の一体が、%ANAME(対象)%の股にペニスを押し当て、そして挿入する
			PRINTFORML かく、かくと、腰が揺れ動く。%ANAME(対象)%の膣穴が、犯されている
			PRINTFORMW やめろと絶叫するが、研究者の男は聞いていないようだった
			PRINTFORMW 「そう心配しなくていいよ。大丈夫だから、ほら聞こえるだろ？　彼女も嫌がってはいない」
			PRINTFORML 味気ないリズムで響く、肉のぶつかる音と、濡れた蜜の音。それに混じって、女の声が聞こえてくる
			PRINTFORML
			PRINTFORMW ……他ならぬ%ANAME(対象)%の、嬌声が
			PRINTFORML
			PRINTFORMW 「嫌がってなんて、いるはずないじゃないか。これは飴と鞭の飴だよ？　だれだって飴を選ぶよ、それは」
			PRINTFORMW 「だから君は何も心配しなくていい」
			PRINTFORML 悪い夢のようだった。壁に頭を打ち付ける。夢は覚めてくれない。当然だ。これは夢ではないのだから
			PRINTFORML 恋人が地獄のような責め苦を味わわされていたというのに、そして今も、目の前で犯されているというのに、何もできない
			PRINTFORMW こんな鉄格子一つ隔てただけで――%ANAME(MASTER)%は、あまりにも無力だった
			PRINTFORMW 「ほら、そろそろじゃないか」
			PRINTFORML %ANAME(対象)%を犯す男の動きが、どんどんと速まっていく。それが何を意味するか、%ANAME(MASTER)%にも理解できる
			PRINTFORMW もうやめてくれ。当初の勢いも失い、うちひしがれたように呟く%ANAME(MASTER)%へ、他ならぬ%ANAME(対象)%が追い打ちをかける
			PRINTFORML
			PRINTFORMW 膣内に射精してくださいませ――
			PRINTFORML
			PRINTFORMW 彼女は間違いなく、そう言った。恋人である%ANAME(MASTER)%以外の種を受け止めたいと、そう言ったのだ
			PRINTFORMW 「うーん、素晴らしい。彼女のコンセプトは『万人への隷属』なんだ」
			PRINTFORMW 「普通は特定の誰かに隷属するものだろ？　でも彼女は違う。自分に関わるあらゆるものに隷属してもらった」
			PRINTFORMW 「これは希有な例だよ。実に貴重だ。あっ、もちろん君にも隷属するよ。あとで何か命令して試すといいよ」
			PRINTFORML 自画自賛する芸術家のような口調で、研究者は語る
			PRINTFORML だが、彼の言葉など、%ANAME(MASTER)%は聞いていなかった。何も聞きたくなかったし、何も見たくなかった
			PRINTFORMW ただ、このクソッタレな何かが、少しでも早く終わってくれることを願うばかりだった
			PRINTFORMW そして、その「終わり」は、すぐに来た
			PRINTFORML 人形のような男が、腰を深く前に突き出す。%ANAME(対象)%の背中が反り、一際高い、悦びの声が上がる
			PRINTFORMW 絶頂したと、見ただけで分かる光景だった
			PRINTFORML たっぷり十秒ほどもあっただろうか。睾丸の中身を全て吐き出しきった男は、%ANAME(対象)%の肉穴からペニスを引き抜く
			PRINTFORMW どろりと、収まりきらないものが垂れる。申し訳ありませんと、%ANAME(対象)%は呟いた。貴重な種をこぼしてしまいましたと
			PRINTFORMW 彼女は起き上がり、先ほどまで自らを貫いていたモノに、その口で奉仕を始める。それを研究者は止めた
			PRINTFORMW 「おっと%ANAME(対象)%。言いつけ通りにできたのは偉いが、ちょっと待った。今は僕の用事の方が優先だ」
			PRINTFORMW 「これは%ANAME(MASTER)%くん。前に言ったろ？　君の新しいご主人様だ。さあ、挨拶しなさい」
			PRINTFORMW %ANAME(対象)%はモノから口を離し、そしてこちらへふらふらと近づいてくる。地に膝を付け、額を付け、鉄格子越しに言った
			PRINTFORML
			PRINTFORMW ご主人様、これからこの%ANAME(対象)%を、よろしくお願いいたします――
			PRINTFORML
			PRINTFORMW そこに、%ANAME(対象)%の面影は、残っていなかった
			PRINTFORMW 「さ！　約束通り、君達をここから解放しよう。帰ってもらって結構だ」
			PRINTFORMW 「ただ、またここに来るようなことをするのは勘弁してくれよ？　我々は本来、野蛮な戦いには向いていないしね」
			PRINTFORML 男は%ANAME(MASTER)%の檻の鍵を開けると、さっさと立ち去ってしまった
			PRINTFORMW 追いかけて、殺すことはできる。けれども、%ANAME(MASTER)%にはそれをする気力すら残っていなかった
			PRINTFORMW ――なにより、あれを殺したところで、壊されてしまった%ANAME(対象)%が、元に戻るわけではないのだ
			PRINTFORMW 立ち上がる。牢から出る。%ANAME(対象)%の残骸を抱きしめる
			PRINTFORMW どうかされましたか、ご主人様、泣かないで下さい――耳元に、呪いのような言葉が流し込まれ続けていた……
			CALL COLORPRINTFORM(@"%ANAME(MASTER)%と%ANAME(対象)%は、解放されました", COLOR("注意"), "W")
			CALL COLORPRINTFORM(@"%ANAME(対象)%が壊れました", COLOR("警告"), "W")
			CALL COLORPRINTFORM(@"%ANAME(対象)%の素質が変化しました", COLOR("警告"), "W")
			CFLAG:対象:好感度 = 0
			CFLAG:対象:依存度 = 3000
			CFLAG:対象:従属度 = 10000
			TALENT:対象:恋慕 = 0
			TALENT:対象:親愛 = 0
			TALENT:対象:恋人 = 0
			TALENT:対象:服従 = 1
			TALENT:対象:隷属 = 1
			TALENT:対象:合意 = 1
			TALENT:対象:素直 = 1
			TALENT:対象:反抗的 = 0
			TALENT:対象:生意気 = 0
			TALENT:対象:プライド高い = 0
			TALENT:対象:好奇心 = 0
			TALENT:対象:無関心 = 1
			TALENT:対象:感情乏しい = 1
			TALENT:対象:一線越えない = 1
			TALENT:対象:抑圧 = 1
			TALENT:対象:Ｓ気質 = 0
			TALENT:対象:献身的 = 1
			TALENT:対象:陰毛現在値 = 陰毛_ハート型
			TALENT:対象:陰毛目標値 = 陰毛_ハート型
			TALENT:対象:性的嗜好 = 性的嗜好_ＳＭされる
			TALENT:対象:性的嗜好ロック = 1
			CALL VIRGIN_COMMON(対象, -12)
			CALL KISS_COMMON(対象, @"外来人のペニス")
			EXP:対象:絶頂経験 += RAND(1000, 1500)
			EXP:対象:苦痛快楽経験 += RAND(500, 1000)
			EXP:対象:Ｖ拡張経験 += RAND(30, 50)
			EXP:対象:Ａ拡張経験 += RAND(30, 50)
			EXP:対象:緊縛経験 += RAND(200, 500)
			EXP:対象:口淫経験 += RAND(200, 300)
			EXP:対象:トラウマ経験 += RAND(1000, 2000)
			EXP:対象:輪姦経験 += RAND(200, 250)
			EXP:対象:獣姦経験 += RAND(200, 250)
			ABL:対象:Ｃ感 += RAND(4,6)
			ABL:対象:Ｖ感 += RAND(4,6)
			ABL:対象:Ａ感 += RAND(4,6)
			ABL:対象:Ｂ感 += RAND(4,6)
			ABL:対象:Ｍ感 += RAND(4,6)
			ABL:対象:欲望 += RAND(4,6)
			ABL:対象:性技 += RAND(4,6)
			ABL:対象:奉仕 += RAND(4,6)
			ABL:対象:性交 += RAND(4,6)
			ABL:対象:自慰 += RAND(4,6)
			ABL:対象:精愛 += RAND(4,6)
			ABL:対象:排泄 += RAND(4,6)
			ABL:対象:主導度Ｎ = MIN(-700, ABL:対象:主導度Ｎ)
			ABL:対象:主導度Ｕ = MIN(-700, ABL:対象:主導度Ｕ)
			ABL:対象:倒錯度 = MAX(800, ABL:対象:倒錯度)
			CALL SET_PIERCE_RANDOM(対象, 0)
			CALL SET_PIERCE_RANDOM(対象, 0)
			CALL SET_PIERCE_RANDOM(対象, 0)
			CALL SET_PIERCE_RANDOM(対象, 0)
			CALL SET_TATOO_RANDOM(対象, STR_FOR_TATOO(-1), 0)
			CALL SET_TATOO_RANDOM(対象, STR_FOR_TATOO(-1), 0)
			CALL SET_TATOO_RANDOM(対象, STR_FOR_TATOO(-1), 0)
			CALL SET_TATOO_RANDOM(対象, STR_FOR_TATOO(-1), 0)
			FOR LOCAL, 0, 5
				SIF TRAINNAME:LOCAL != ""
					COM_EXP:対象:(LOCAL + 300) += RAND(500, 1000)
			NEXT
			FOR LOCAL, 10, 16
				SIF TRAINNAME:LOCAL != ""
					COM_EXP:対象:LOCAL += RAND(500, 1000)
			NEXT
			COM_EXP:対象:320 += RAND(500, 1000)
			FOR LOCAL, 30, 80
				SIF !GROUPMATCH(LOCAL, 50, 75) && TRAINNAME:LOCAL != "" 
					COM_EXP:対象:(LOCAL + 300) += RAND(500, 1000)
			NEXT
			FOR LOCAL, 80, 100
				SIF TRAINNAME:LOCAL != ""
					COM_EXP:対象:(LOCAL + 300) += RAND(1000, 1500)
			NEXT
			FOR LOCAL, 100, 120
				SIF !GROUPMATCH(LOCAL, 108, 109, 112, 113, 114) && TRAINNAME:LOCAL != ""
					COM_EXP:対象:(LOCAL) += RAND(500, 1000)
			NEXT
			COM_EXP:対象:412 += RAND(500, 1000)
			COM_EXP:対象:413 += RAND(500, 1000)
			COM_EXP:対象:414 += RAND(500, 1000)
			COM_EXP:対象:130 += RAND(500, 1000)
			COM_EXP:対象:431 += RAND(500, 1000)
			COM_EXP:対象:432 += RAND(500, 1000)
			COM_EXP:対象:440 += RAND(500, 1000)
			COM_EXP:対象:441 += RAND(500, 1000)
			FOR LOCAL, 80, 160
				SIF TRAINNAME:LOCAL != ""
					COM_EXP:対象:(LOCAL + 300) += RAND(1000, 1500)
			NEXT
			FOR LOCAL, 0, 200
				SIF TRAINNAME:LOCAL != ""
					CFLAG:対象:(LOCAL / 60 + 100) |= (1 << (LOCAL % 60))
			NEXT
			CFLAG:MASTER:捕虜先 = 0
			CFLAG:対象:捕虜先 = 0
			RETURN 1
		ENDIF
	ENDIF
	IF !VAGINA(MASTER) && GAIRAI_SEX_VS(MASTER) != 1
		DRAWLINE
		PRINTFORMW 外来人は%ANAME(MASTER)%に、男娼にされたいか、女にされて犯されたいか聞いてきた
		CALL ASK_YN("女にされるなんて御免だ！(男娼化)", "いっそ女にされた方がマシだ…(女性化)")
		IF RESULT == 0
			PRINTFORMW 外来人は%ANAME(MASTER)%の返事を聞くと、%ANAME(MASTER)%を取り押さえ裸に剥き、縄で拘束した
			PRINTFORMW どうやら男であろうと本気で犯すつもりのようだ…
		ELSE
			PRINTFORMW 外来人は%ANAME(MASTER)%の返事を聞くと、%ANAME(MASTER)%の口に何かを押し込んで無理やり飲ませた
			PRINTFORMW すると突然意識が遠くなっていく…
			PRINTFORMW ………………
			PRINTFORMW ……
			PRINTFORMW しばらくして目を覚ますと、%ANAME(MASTER)%は体に違和感を覚えた
			PRINTFORMW 股間にはあるべきものがなく、胸にも重みを感じる
			PRINTFORMW どうやら本当に女性の体になってしまったようだ
			PRINTFORMW 周りを取り囲む外来人たちの視線が肌に突き刺さり、思わず%ANAME(MASTER)%は身震いした…
			IF TALENT:MASTER:性別 == 4
				;元男の娘フラグ
				CFLAG:MASTER:66 = 1
			ENDIF
			TALENT:MASTER:性別 = 1
		ENDIF
	ENDIF
ENDIF


;四回ごとに誘われる
IF FLAG:47 > 0 && FLAG:47 % 4 == 0
	PRINTFORML 調教の時間が近づくと、%ANAME(MASTER)%はいつものように「研究室」で拘束され、
	PRINTFORMW あとは外来人に好き放題されるのを待つのみとなった
	PRINTFORMW ところが、やってきた外来人たちは、意外なことを言い始める
	PRINTFORMW 君は研究対象として素晴らしい、実に模範的だ
	PRINTFORMW もし我々に協力してくれるなら、ある程度の行動の自由は認めよう、と……
	PRINTFORML このまま拒否し続けても、こいつらは自分を汚し続けるだろう
	PRINTFORML 首を縦に振れば、いくらかは楽になれるのかもしれない
	PRINTFORMW どうするべきだろうか……
	CALL ASK_YN("諦めて受け入れる（奴隷化)", "こんなやつらの奴隷なんてごめんだ")
	IF RESULT == 0
		PRINTFORML %ANAME(MASTER)%が頷くと、彼らは満足気に笑った
		IF RAND:3
			CALL SET_PIERCE_RANKED(MASTER, 0, ピアス_ラビア, ピアス_ペニス, ピアス_クリトリス, ピアス_乳首, ピアス_へそ, ピアス_耳, ピアス_舌, ピアス_鼻)
			SIF RESULT != -1
				CALL COLORPRINTFORM(@"%ANAME(MASTER)%の%GET_PIERCE_NAME(RESULT)%に、研究対象であることを示すピアスが取り付けられた……", COLOR("桃"), "W")
		ELSE
			CALL SET_TATOO_RANKED(MASTER, "研究用奴隷", 0, タトゥー_秘部, タトゥー_尻, タトゥー_頬, タトゥー_額, タトゥー_肩, タトゥー_胸, タトゥー_背, タトゥー_腹, タトゥー_腿, タトゥー_足首)
			SIF RESULT != -1
				CALL COLORPRINTFORM(@"%ANAME(MASTER)%の%GET_TATOO_NAME(RESULT)%に、研究対象であることを示すタトゥーが刻まれた……", COLOR("桃"), "W")
		ENDIF
		PRINTFORMW さらにその首に、管理用の首輪が嵌められた
		SETCOLOR COLOR("注意")
		PRINTFORMW %ANAME(MASTER)%は外来人たちの研究用奴隷となりました
		RESETCOLOR
		TALENT:MASTER:研究用奴隷の烙印 = 1
		CFLAG:MASTER:1 = GET_COUNTRY_FROM_ID(COUNTRY_GAIRAI)
		CFLAG:MASTER:9 = 0
		FOR LOCAL:0, 0, CHARANUM
			IF TALENT:(LOCAL:0):外来人
				TALENT:(LOCAL:0):合意 = 1
				CFLAG:(LOCAL:0):2 = MAX(CFLAG:(LOCAL:0):2, 500)
				CFLAG:(LOCAL:0):3 = MAX(CFLAG:(LOCAL:0):3, 500)
			ENDIF
		NEXT
		RETURN 1
	ELSE
		PRINTFORML そうかと、%ANAME(MASTER)%の拒否を特に気にした風でもなく外来人たちは受け入れる
		PRINTFORML それは仕方ない、ではこのまま研究に入るよと、%ANAME(MASTER)%に群がっていく……
	ENDIF
ENDIF
;全員の調教参加フラグを解除
CVARSET CFLAG, 6, 0

;4回目以降、1/5の確率で外来に寝返った顔見知りのキャラが調教者になる
IF FLAG:47 >= 4 && RAND:5 == 0
	LOCAL:1 = 0
	FOR LOCAL:0, 0, CHARANUM
		IF CFLAG:(LOCAL:0):面識 && NO:(LOCAL:0) < 2000 && CFLAG:(LOCAL:0):所属 == CFLAG:MASTER:捕虜先 && TALENT:(LOCAL:0):研究用奴隷の烙印 && !RAND:2
			候補:候補数 = LOCAL:0
			候補数 ++
		ENDIF
	NEXT
	IF 候補数
		CALL FISHER_YATES_SHAFFLE(候補数)
		FOR LOCAL, 0, MIN(候補数, 4)
			参加者:参加者数 = 候補:(SHAFFLE_ARRAY:(LOCAL:0))
			CFLAG:(参加者:参加者数):6 = 1
			参加者数 ++
		NEXT
		IF 参加者数
			LOCALS:0 = 
			FOR LOCAL:0, 0, 参加者数
				IF LOCALS:0 == ""
					LOCALS:0 = %ANAME(参加者:LOCAL)%
				ELSE
					LOCALS:0 = %LOCALS:0%、%ANAME(参加者:LOCAL)%
				ENDIF
			NEXT
			DRAWLINE
			PRINTFORML 調教の時間が近づくと、%ANAME(MASTER)%はいつものように調教部屋で拘束され、
			PRINTFORMW あとは男達に汚されるのを待つのみとなった
			IF 参加者数
				PRINTFORMW やってきた外来人は、%ANAME(MASTER)%が良く見知った相手を連れてきていた
				PRINTFORMW %LOCALS:0%…
				PRINTFORMW かつての面影は既になく、どこか虚ろで生気のない瞳をしている
				PRINTFORMW 怪しげなヘッドギアやケーブルをあちこちに取り付けられているというのに、皆それを疑問にも思っていないようだった
				IF IS_FEMALE(参加者:0)
					PRINTFORMW 事前にたっぷりと犯されてきたのだろう、両方の穴は既に愛液と精液でドロドロに濡れている
					IF PENIS(MASTER)
						PRINTFORMW 性欲に満ちた視線は、%ANAME(MASTER)%ではなく、%ANAME(MASTER)%のいきり立った男根に注がれていた…
					ELSE
						PRINTFORMW 性欲に満ちた視線は、%ANAME(MASTER)%ではなく、%ANAME(MASTER)%のカラダに対して注がれていた…
					ENDIF
				ELSE
					PRINTFORMW 事前にたっぷりと犯されてきたのだろう、全身は白濁にまみれている
					IF PENIS(MASTER)
						PRINTFORMW 性欲に満ちた視線は、%ANAME(MASTER)%ではなく、%ANAME(MASTER)%のいきり立った男根に注がれていた…
					ELSE
						PRINTFORMW 性欲に満ちた視線は、%ANAME(MASTER)%ではなく、%ANAME(MASTER)%のカラダに対して注がれていた…
					ENDIF
				ENDIF
			ENDIF
			FLAG:29 = 1
		ENDIF
	ENDIF
ENDIF
IF 参加者数
	ループ数 = MIN(4, VARSIZE("参加者") - 参加者数)
ELSE
	ループ数 = 4
ENDIF

FOR LOCAL:0, 0, ループ数
	;確率で犬豚が対象に
	IF !RAND:8
		FOR LOCAL:1, 0, CHARANUM
			IF CFLAG:(LOCAL:1):所属 == 外来 && IS_ANIMAL(LOCAL:1) && !CFLAG:(LOCAL:1):6
				参加者:参加者数 =  LOCAL:1
				参加者数 ++
				CFLAG:(LOCAL:1):6 = 1
				BREAK
			ENDIF
		NEXT
		CALL ADD_ANIMAL(@"\@ RAND:2 ? 犬 # 豚 \@", LOCAL:6)
		CFLAG:(CHARANUM -1):6 = 1
		参加者:参加者数 =  CHARANUM - 1
		参加者数 ++
	;普通に外来を選出
	ELSE
		FOR LOCAL:1, 0, CHARANUM
			IF TALENT:(LOCAL:1):外来人 && !CFLAG:(LOCAL:1):6 && CFLAG:(LOCAL:1):所属 == 外来
				参加者:参加者数 =  LOCAL:1
				参加者数 ++
				CFLAG:(LOCAL:1):6 = 1
				CFLAG:(LOCAL:1):64 = 1
				CFLAG:(LOCAL:1):65 = 1
				ABL:(LOCAL:1):欲望 = 5
				ABL:(LOCAL:1):奉仕 = 5
				ABL:(LOCAL:1):性技 = 10
				ABL:(LOCAL:1):主導度Ｕ = 600
				ABL:(LOCAL:1):倒錯度 = 600
				TALENT:(LOCAL:1):性別 = GAIRAI_SEX_VS(MASTER)
				TALENT:(LOCAL:1):快感に素直 = 1
				TALENT:(LOCAL:1):絶倫 = 1
				IF !PENIS(LOCAL:1) && PENIS(MASTER)
					ABL:(LOCAL:1):性交 = 0
					ABL:(LOCAL:1):Ｖ感 = 4
					TALENT:(LOCAL:1):濡れやすい = 1
					EXP:(LOCAL:1):♀♂性交回数 = 500
					EXP:(LOCAL:1):絶頂経験 = 3000
				ELSE
					ABL:(LOCAL:1):性交 = 15
					EXP:(LOCAL:1):♂♀性交回数 = 500
					EXP:(LOCAL:1):♂Ａ性交回数 = 500
					EXP:(LOCAL:1):絶頂経験 = 3000
					IF PENIS(LOCAL:1)
						ABL:(LOCAL:1):射精 = 3000
					ENDIF
				ENDIF
				FOR LOCAL:2, 0, 900
					COM_EXP:(LOCAL:1):(LOCAL:2) = 1000
				NEXT
				BREAK
			ENDIF
		NEXT
	ENDIF
NEXT

FOR LOCAL:0, 0, 参加者数
	CFLAG:(参加者:(LOCAL:0)):6 = 1
NEXT
;逆調教モード
FLAG:12 = 4
;ウフフモード
FLAG:50 = 1
;アイテムを一通り追加
ITEM:A_ローター = 1
ITEM:A_バイブ = 1
ITEM:A_アナルバイブ = 1
ITEM:A_ペニスバンド = 1
ITEM:A_オナホール = 1
ITEM:A_クリキャップ = 1
ITEM:A_ニプルキャップ = 1
ITEM:A_針 = 1
ITEM:A_鞭 = 1
ITEM:A_媚薬 = 99
ITEM:A_排卵誘発剤 = 99
IF GAIRAI_SEX_VS(MASTER) != 1 || !PENIS(MASTER)
	ITEM:A_ローション = 99
	ITEM:A_ペニスバンド = 1
ENDIF
;回数をカウント
FLAG:47 ++
;解放カウンタをリセット
CFLAG:MASTER:43 = 0

