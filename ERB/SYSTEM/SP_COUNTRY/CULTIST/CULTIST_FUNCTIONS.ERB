;--------------------------------------
;ターンエンド時の外来兵の処理
;--------------------------------------
@TURNEND_CULTIST
#DIM 狂信者

狂信者 = GET_COUNTRY_FROM_ID(SP_COUNTRY_ID:特殊勢力_狂信者)

;兵力の増える処理
IF DAY % 3 == 0
	CALL SINGLE_DRAWLINE
	LOCAL:0 = MAX(RAND:3000, 1000)
	PRINTFORML 狂信者につけば「実験」のおこぼれにあずかれると聞いた野良妖怪たちが、次々と寝返っているようです……
	PRINTFORML 狂信者軍の兵力が{LOCAL:0}増加した
	COUNTRY_SOLDIER:狂信者 += LOCAL:0
ENDIF

;5ターンに1回、ブレインコントロール
;CALL CULTIST_BRAINCONTROL(DAY % 5 == 0)

;--------------------------------------
;滅亡時の処理
;--------------------------------------
@CULTIST_DESTROY_MSG
CALL SINGLE_DRAWLINE
SETCOLOR カラー_注意
PRINTFORML
PRINTFORML
PRINTFORML
PRINTFORMW 滅びを悟った狂信者たちの教祖は、自らの肉体を捨て去り魂を次のステージへと踏み出したようです
PRINTFORMW 狂信者たちも後を追ったため、彼らは解散しました！
PRINTFORML
PRINTFORML
PRINTFORML
RESETCOLOR
CALL SINGLE_DRAWLINE

;--------------------------------------
;外来勢力の初期化処理
;--------------------------------------
@CULTIST_INIT(ARG:0)
#DIM LCOUNT
VARSET LOCAL

SIF GET_COUNTRY_FROM_ID(SP_COUNTRY_ID:(特殊勢力_狂信者)) != -1
	RETURN 0

SIF SP_COUNTRY_RANK:特殊勢力_狂信者 == 0
	RETURN 0

LOCAL:4 = GET_NEW_COUNTRY()

;作れなかったらなしで
IF LOCAL:4 == -1
	RETURN 0
ENDIF

COUNTRY_COLOR:(LOCAL:4) = 0xB43104
COUNTRY_SOLDIER:(LOCAL:4) = 20000 + SP_COUNTRY_RANK:(特殊勢力_狂信者) * 1000 + SUMARRAY(CITY_ECONOMY) / 2000
COUNTRY_AI_TYPE:(LOCAL:4) = AI_蛮行
COUNTRY_EVENT_ID:(LOCAL:4) = SP_COUNTRY_ID:(特殊勢力_狂信者)
MONEY:(LOCAL:4) = SUMARRAY(CITY_ECONOMY) / 100

CALL ADD_VOID_CHARA()
LOCAL = RESULT
SELECTCASE SP_COUNTRY_BOSSNAME:(特殊勢力_狂信者)
	CASE 0
		NAME:LOCAL = 狂信者
		CALLNAME:LOCAL = 狂信者
		CSTR:LOCAL:1 = 狂信者
		CSTR:LOCAL:3 = キョウシンシャ
		CSTR:LOCAL:4 = キョウシンシャ
		CSTR:LOCAL:6 = キョウシンシャ
	CASE 1
		NAME:LOCAL = 教祖
		CALLNAME:LOCAL = 教祖
		CSTR:LOCAL:1 = 教祖
		CSTR:LOCAL:3 = キョウソ
		CSTR:LOCAL:4 = キョウソ
		CSTR:LOCAL:6 = キョウソ
	CASE 2
		TARGET = LOCAL
		CALL SET_RANDOM_NAME_J(LOCAL)
		NAME:LOCAL = %CSTR:LOCAL:1%
		CALLNAME:LOCAL = %CSTR:LOCAL:1%
	CASE 3
		NAME:LOCAL = %SP_COUNTRY_BOSSNAME_FIRST_NAME:特殊勢力_狂信者%
		CALLNAME:LOCAL = %SP_COUNTRY_BOSSNAME_FIRST_NAME:特殊勢力_狂信者%
		CSTR:LOCAL:0 = %SP_COUNTRY_BOSSNAME_LAST_NAME:特殊勢力_狂信者%
		CSTR:LOCAL:1 = %SP_COUNTRY_BOSSNAME_FIRST_NAME:特殊勢力_狂信者%
ENDSELECT
MAXBASE:LOCAL:体力 = 3000
MAXBASE:LOCAL:気力 = 3000
MAXBASE:LOCAL:精神力 = 1500
BASE:LOCAL:体力 = MAXBASE:LOCAL:体力
BASE:LOCAL:気力 = MAXBASE:LOCAL:気力
BASE:LOCAL:精神力 = MAXBASE:LOCAL:精神力
ABL:LOCAL:Ｃ感 = 3
ABL:LOCAL:欲望 = 5
ABL:LOCAL:性技 = 4
ABL:LOCAL:性知識 = 5
ABL:LOCAL:奉仕 = 4
ABL:LOCAL:性交 = 2
ABL:LOCAL:露出 = 3
ABL:LOCAL:射精 = 3
ABL:LOCAL:排泄 = 2
ABL:LOCAL:主導度Ｕ = 700
ABL:LOCAL:主導度Ｎ = 300
ABL:LOCAL:倒錯度 = 600
EXP:LOCAL:絶頂経験 = 500
ABL:LOCAL:武闘 = 40 + 3 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
ABL:LOCAL:防衛 = 40 + 5 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
ABL:LOCAL:知略 = 50 + 4 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
ABL:LOCAL:政治 = 50 + 5 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
ABL:LOCAL:歌唱 = 20
ABL:LOCAL:料理 = 20
ABL:LOCAL:肝臓 = 4
TALENT:LOCAL:絶倫 = 1
TALENT:LOCAL:特殊勢力素質 = 特殊勢力_狂信者
TALENT:LOCAL:陰毛現在値 = 陰毛_標準
TALENT:LOCAL:陰毛目標値 = 陰毛_標準
TALENT:LOCAL:Ｖ締まり = GET_DEFAULT_TIGHTNESS("普通")
TALENT:LOCAL:Ａ締まり = GET_DEFAULT_TIGHTNESS("普通")
CFLAG:LOCAL:1 = LOCAL:4
CALL SKILL_LEARN(LOCAL, FINDELEMENT(SKILL_GENRE_ENG, "SP"), SKILL_SP_COUNTRY_NO:特殊勢力_狂信者, 0)
CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_上下服, "修道服")
CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_下着下, "トランクス")
CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_靴下, "靴下")
CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_靴, "靴")
CALL SKILL_LEARN(LOCAL, FINDELEMENT(SKILL_GENRE_ENG, "SP"), SKILL_SP_COUNTRY_NO:特殊勢力_狂信者, 0)
COUNTRY_BOSS:(LOCAL:4) = GET_ID(LOCAL)

FOR LCOUNT, 0, SP_COUNTRY_RANK:特殊勢力_狂信者 * 2
	CALL ADD_VOID_CHARA()
	LOCAL = RESULT
	NAME:LOCAL = 狂信者%UNICODE(0xFF21 + LCOUNT)%
	CALLNAME:LOCAL = 狂信者%UNICODE(0xFF21 + LCOUNT)%
	MAXBASE:LOCAL:体力 = 3000
	MAXBASE:LOCAL:気力 = 3000
	MAXBASE:LOCAL:精神力 = 1500
	BASE:LOCAL:体力 = MAXBASE:LOCAL:体力
	BASE:LOCAL:気力 = MAXBASE:LOCAL:気力
	BASE:LOCAL:精神力 = MAXBASE:LOCAL:精神力
	ABL:LOCAL:Ｃ感 = 3
	ABL:LOCAL:欲望 = 5
	ABL:LOCAL:性技 = 4
	ABL:LOCAL:性知識 = 5
	ABL:LOCAL:奉仕 = 4
	ABL:LOCAL:性交 = 2
	ABL:LOCAL:露出 = 3
	ABL:LOCAL:射精 = 3
	ABL:LOCAL:排泄 = 2
	IF !RAND:3
		TALENT:LOCAL:性別 = 1
		ABL:LOCAL:Ｂ感 = 3
		ABL:LOCAL:Ｖ感 = 3
		ABL:LOCAL:Ａ感 = 3
		ABL:LOCAL:レズ = 2
	ENDIF
	ABL:LOCAL:主導度Ｕ = 700
	ABL:LOCAL:主導度Ｎ = 300
	ABL:LOCAL:倒錯度 = 600
	EXP:LOCAL:絶頂経験 = 500
	ABL:LOCAL:武闘 = 40 + 3 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
	ABL:LOCAL:防衛 = 40 + 5 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
	ABL:LOCAL:知略 = 40 + 4 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
	ABL:LOCAL:政治 = 40 + 5 * SP_COUNTRY_ABL_MODIFIER(特殊勢力_狂信者) + RAND:20
	ABL:LOCAL:料理 = 10
	ABL:LOCAL:肝臓 = 3
	TALENT:LOCAL:絶倫 = 1
	TALENT:LOCAL:特殊勢力素質 = 特殊勢力_狂信者
	TALENT:LOCAL:陰毛現在値 = 陰毛_標準
	TALENT:LOCAL:陰毛目標値 = 陰毛_標準
	TALENT:LOCAL:Ｖ締まり = GET_DEFAULT_TIGHTNESS("普通")
	TALENT:LOCAL:Ａ締まり = GET_DEFAULT_TIGHTNESS("普通")
	;所属を野盗勢力にする
	CFLAG:LOCAL:1 = LOCAL:4
	CALL SKILL_LEARN(LOCAL, FINDELEMENT(SKILL_GENRE_ENG, "BASE"), SKILL_SP_COUNTRY_NO:特殊勢力_狂信者, 0)
	CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_上下服, "修道服")
	CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_下着下, "トランクス")
	CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_靴下, "靴下")
	CALL SET_CLOTH_BY_NAME(LOCAL, 衣装部位_靴, "靴")
NEXT
SP_COUNTRY_APPEARED:特殊勢力_狂信者 = 1

RETURN LOCAL:4

;-----------------------------------
;外来勢力に捕らえられたときのイベント
;-----------------------------------
@MASTER_CAPTURED_CULTIST(ARG:0)
PRINTFORMW 捕らえられた%ANAME(MASTER)%は狂信者たちに取り囲まれた
IF GETBIT(TALENT:MASTER:特殊勢力陥落系, 特殊勢力_狂信者)
	PRINTFORML 君は我々の仲間ではないか、どうして異端者どもに加わっていたんだ
	PRINTFORMW さあ、また神に仕えようではないか
	PRINTFORMW 狂信者たちは当然のように、%ANAME(MASTER)%を仲間に加えようとしてくるが……
	CALL ASK_YN("受け入れる", "拒否する")
	IF RESULT == 0
		PRINTFORMW もちろん、神に逆らおうなどと考えるはずもない
		PRINTFORMW %ANAME(MASTER)%の身体は疼き、自ら彼らに加わることに同意した
		PRINTFORMW 彼らの用意した法衣を身にまとうと、深い悦びが%ANAME(MASTER)%を包む
		PRINTFORMW 俗世の穢れた空気を吸わぬよう誂えられた覆面をかぶり、%ANAME(MASTER)%は再び彼らの一員となった……
		SETCOLOR カラー_注意
		PRINTFORMW %ANAME(MASTER)%は再び、狂信者たちに加わりました
		RESETCOLOR
	ELSE
		PRINTFORMW 思想を押し付けるな。%ANAME(MASTER)%は主張した
		PRINTFORMW 狂信者たちにはその態度が理解できないようだった
		PRINTFORMW 異端者に紛れて毒されたか、我々の正しい教義を教え込んでやらねばならない
		PRINTFORMW わきたつ狂信者たちは、%ANAME(MASTER)%を取り押さえ、枷で縛り、牢獄へと放り込んだ……
	ENDIF
ELSE
	PRINTFORML 異端者は本来、牢に放り込み、我々の教義を爪先から頭のてっぺんまで刷り込むことになっている
	PRINTFORMW だがお前は見どころがありそうだと呟いた
	PRINTFORMW 自ら教義を受け入れるというのなら、異端者であった罪を許し、牢獄行きは免除するとのことだが……
	PRINTFORMW 受け入れますか？
	CALL ASK_YN("受け入れる", "拒否する")
	IF RESULT == 0
		PRINTFORMW 投獄されるよりはマシだろう。%ANAME(MASTER)%が頷くと、狂信者たちは満足げに頷いた
		PRINTFORMW では法衣を身にまとえといわれ、%ANAME(MASTER)%はおとなしく従う
		PRINTFORMW 俗世の穢れた空気を吸わぬよう誂えられた覆面をかぶり、%ANAME(MASTER)%は彼らの一員となった……
		SETCOLOR カラー_注意
		PRINTFORMW %ANAME(MASTER)%は再び、狂信者たちに加わりました
		RESETCOLOR
	ELSE
		PRINTFORMW お前達になど手を貸すか。%ANAME(MASTER)%は毅然として言い放つ	
		PRINTFORMW その業を牢獄で清めるがよいと、彼らはそのまま%ANAME(MASTER)%を投獄した……
	ENDIF
ENDIF
IF RESULT == 0
	SETBIT TALENT:MASTER:特殊勢力陥落系, 特殊勢力_狂信者
	CFLAG:MASTER:所属 = ARG:0
	FOR LOCAL:0, 0, CHARANUM
		IF TALENT:(LOCAL:0):特殊勢力素質 == 特殊勢力_狂信者
			TALENT:(LOCAL:0):合意 = 1
			CFLAG:(LOCAL:0):2 = MAX(CFLAG:(LOCAL:0):2, 500)
			CFLAG:(LOCAL:0):3 = MAX(CFLAG:(LOCAL:0):3, 500)
		ENDIF
	NEXT
	RETURN 0
ELSE
	CALL CAPTURE(MASTER, ARG:0)
	RETURN 2
ENDIF

;--------------------------------------
;エンディング
;--------------------------------------
@CULTIST_ENDING
PRINTFORML 狂信者たちは布教に成功した
PRINTFORMW 方法はどうあれ、彼らはその思想を幻想郷の隅々にまで浸透させたのだ
PRINTFORML 今日も彼らの儀式は行われている
PRINTFORML あちこちで男と女が交わり、人ならざるものが呼び出されては、贄の少女に神聖な種を植え付けていく
PRINTFORML これこそが、彼らの望んでいた楽園だった……
IF CFLAG:MASTER:所属 == GET_COUNTRY_FROM_ID(SP_COUNTRY_ID:特殊勢力_狂信者) && IS_FEMALE(MASTER)
	PRINTFORMW 
	PRINTFORMW 信者たちの中に、%ANAME(MASTER)%の姿もあった
	PRINTFORMW 模範的な信者ということで名を馳せ、今や幹部にまで上り詰めている
	PRINTFORMW ……そして、女信者として最高の名誉、神との交わりの栄誉を賜るに至った
	PRINTFORMW 特殊な排卵誘発剤を飲んだ%ANAME(MASTER)%は、神の子を宿す悦びに下腹を疼かせている
	PRINTFORML 儀式より呼び出された巨大な肉塊――彼らの「神」が、%ANAME(MASTER)%に覆い被さり、肉穴にグロテスクなモノをねじ込む
	PRINTFORMW %ANAME(MASTER)%は、たまらないといった声をあげ、何度も放たれる精液を肉穴で受け止めていく 
	PRINTFORMW 信者たちは神聖なる「儀式」を前に恭しくひれ伏し、神の子の誕生を寿いでいる……
ENDIF
PRINTFORML 
PRINTFORMW 誰も不幸などではない。もはや幻想郷に、彼らの教えに背く者などいないのだから……
