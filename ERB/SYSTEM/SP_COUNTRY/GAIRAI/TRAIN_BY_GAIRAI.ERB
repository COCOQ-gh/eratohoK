;-------------------------------------------------
;外来勢力による調教
;-------------------------------------------------
@TRAIN_BY_GAIRAI
#DIM 外来
#DIM 対象

外来 = GET_COUNTRY_FROM_ID(SP_COUNTRY_ID:(特殊勢力_外来人))
LOCAL:1 = 0

SIF 外来 == -1 || CONFIG:200
	RETURN -1

FOR 対象, 0, CHARANUM
	SIF !IS_TRAIN_BY_SP_COUNTRY(対象, 外来)
		CONTINUE
	IF !LOCAL:1
		LOCAL:1 = 1
		DRAWLINE
		PRINTFORMW 外来人に捕らえられた士官が「研究」されているようです…
		PRINTFORML 
	ENDIF
	
	CALL GAIRAI_TRAIN_MSG(対象)
	CFLAG:(LOCAL:0):調教カウンタ ++
	
	;あまり長く捕らえられていると寝返る
	IF IS_BETRAY_TO_SP_COUNTRY(対象, 外来)
		PRINTL
		SETCOLOR COLOR("警告")
		IF !GETBIT(TALENT:対象:特殊勢力陥落系, 特殊勢力_外来人)
			PRINTFORMW 外来人たちの度重なる研究により、%ANAME(対象)%の自我は崩壊した
			PRINTFORMW 今は%PRONOUN(対象)%は、彼らのための実験動物でしかない……
			IF TALENT:対象:烙印 && CFLAG:MASTER:所属 != 外来
				PRINTFORML %ANAME(対象)%が%ANAME(MASTER)%専用であることを示す烙印の上から、
				PRINTFORMW 研究用の実験動物であることを示す烙印が焼き入れられた
				TALENT:対象:烙印 = 0
			ELSE
				PRINTFORMW %ANAME(対象)%の体に、研究用の実験動物であることを示す烙印が焼き入れられた
			ENDIF
		ELSE
			PRINTFORMW 最初こそ抵抗していた%ANAME(対象)%だったが、既に外来人に屈したその体は与えられる快楽に敏感に反応してしまう
			PRINTFORMW 触れられるたび、犯されるたび、己が実験動物に過ぎないことを、%ANAME(対象)%は思い出していく
			PRINTFORMW 絶え間なく続けられる陵辱に、ほどなくして%ANAME(対象)%は快感を受け入れ、幸せそうな表情で自ら奉仕を始めた…
		ENDIF
		RESETCOLOR
		
		CALL KOJO_SPECIAL_FALLEN_EVENT(対象, SP_COUNTRY_ID:(特殊勢力_外来人))
		
		CFLAG:対象:所属 = 外来
		CFLAG:対象:捕虜先 = 0
		SETBIT TALENT:対象:特殊勢力陥落系, 特殊勢力_外来人
		SIF SP_TRAIN_IS_DECREASE_CFLAG(対象, 外来)
			CALL LOSE_RELATION_TALENT(対象)
			
		SELECTCASE RAND:10
			CASE IS < 3
				CALL SET_PIERCE_RANDOM(対象, 0)
				SIF RESULT != -1
					CALL COLORPRINTFORM(@"%ANAME(対象)%の%GET_PIERCE_NAME(RESULT)%に、実験動物であることを示すピアスが取り付けられた……", COLOR("桃"), "W")
			CASE IS < 7
				CALL SET_TATOO_RANDOM(対象, "実験動物", 0)
				SIF RESULT != -1
					CALL COLORPRINTFORM(@"%ANAME(対象)%の%GET_TATOO_NAME(RESULT)%に、「%TATOO:対象:RESULT%」とタトゥーが刻まれた……", COLOR("桃"), "W")
			CASEELSE
				IF GET_INMOU(対象) >= 陰毛_標準
				CALL COLORPRINTFORM(@"服従の証として、%ANAME(対象)%の陰毛はハート型に整えられた……", COLOR("桃"), "W")
				TALENT:対象:陰毛目標値 = 陰毛_ハート型
				TALENT:対象:陰毛現在値 = 陰毛_ハート型
			ELSE
				CALL COLORPRINTFORM(@"服従の証として、%ANAME(対象)%の陰毛は永久脱毛された……", COLOR("桃"), "W")
				TALENT:対象:陰毛目標値 = 陰毛_パイパン
				TALENT:対象:陰毛現在値 = 陰毛_パイパン
			ENDIF
		ENDSELECT
	ENDIF
	PRINTL
	WAIT
NEXT

