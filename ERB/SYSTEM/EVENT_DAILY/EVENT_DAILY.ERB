;複数シナリオにまたがるイベント処理
@EVENT_DAILY()
VARSET LOCAL

SIF !IS_DAILY_EVENT_HAPPEN(MASTER)
	RETURN 0

;薬売り
SIF !DCONFIG:DCON_薬売り
	CALL SMUGGLER

;金貸し
SIF !DCONFIG:DCON_金貸し
	CALL LENDER

;夜遊び
SIF !DCONFIG:DCON_夜遊び
	CALL NIGHTLIFE

;傭兵
SIF !DCONFIG:DCON_傭兵
	CALL MERCENARY

;用心棒
SIF !DCONFIG:DCON_用心棒
	CALL BOUNCER

;筋肉馬鹿
SIF !DCONFIG:DCON_素質トレーナー
	CALL TALENT_TRAINER

;セックストレーナー
SIF !DCONFIG:DCON_セックストレーナー
	CALL SEX_TRAINER

;外界の医者
SIF !DCONFIG:DCON_外界の医者
	CALL DOCTOR_GAIRAI

;麻薬治療医
SIF !DCONFIG:DCON_麻薬治療医
	CALL DOCTOR_DRUG

;人材要求
SIF !DCONFIG:DCON_人材要求
	CALL DAILY_DIPLO_REQUEST_CHARA

;資金援助要求
SIF !DCONFIG:DCON_資金援助要求
	CALL DAILY_DIPLO_REQUEST_MONEY

;野盗討伐イベント
SIF !DCONFIG:DCON_野盗討伐
	CALL BANDIT_CONQUER

;野盗の身代金要求処理
SIF !DCONFIG:DCON_野盗身代金
	CALL BANDIT_REQUIRE_RANSOM

;肉便器イベント
SIF !DCONFIG:DCON_肉便器
	CALL PUBLIC_TOILET

;薬物依存イベント
SIF !DCONFIG:DCON_薬物依存
	CALL DRUG_ADDICT

;雌犬用イベント
SIF !DCONFIG:DCON_雌犬
	CALL ZOOPHILIA

;苗床用イベント
SIF !DCONFIG:DCON_苗床
	CALL SEEDBED
	
;触手兵イベント
SIF !DCONFIG:DCON_触手兵
	CALL TENTACLE_SOLDIERS

SIF !DCONFIG:DCON_富豪
	CALL MILLIONAIRE

;小型イベント
SIF !DCONFIG:DCON_MISC
	CALL DAILY_MISC

;口上用デイリー MASTERのものは発動しない
FOR LOCAL, 1, CHARANUM
	CALL KOJO_DAILY(LOCAL)
NEXT














;指定キャラについて、「放浪したり死んだりしていない」「捕虜でない」「どこかの勢力に所属している」を満たしているなら真
@IS_DAILY_EVENT_HAPPEN(ARG:0)
#FUNCTION
IF CFLAG:(ARG:0):12 == 0 && CFLAG:(ARG:0):9 == 0 && CFLAG:(ARG:0):1
	RETURNF 1
ENDIF
RETURNF 0



;デイリーイベントにおいて、ランダムに対象キャラを選出する
;捕虜でなく、死んだりしていないのは前提
;ARG:0 0自勢力キャラ　1全勢力から選択
;RESULT 選出された対象キャラ
@DAILY_EVENT_RAND_CHARASELECT(ARG:0 = 0)
#DIM 対象, 1000
#DIM カウンタ, 1
VARSET 対象
VARSET カウンタ
;シャッフル用の配列を作成する
FOR LOCAL, 0, CHARANUM
	IF (ARG:0 || (!ARG:0 && CFLAG:(LOCAL:0):1 == CFLAG:MASTER:1)) && !CFLAG:(LOCAL:0):9 && !CFLAG:(LOCAL:0):12
		対象:カウンタ = LOCAL
		カウンタ ++
	ENDIF
NEXT
IF カウンタ > 0
	CALL FISHER_YATES_SHAFFLE(カウンタ)
	RETURN 対象:(SHAFFLE_ARRAY:0)
ELSE
	RETURN -1
ENDIF

;デイリーイベントにおいて、ランダムに対象都市を選出する
;ARG:0 0自勢力都市　1全勢力から選択
;RESULT 選出された対象都市
@DAILY_EVENT_RAND_CITYSELECT(ARG:0 = 0)
#DIM 対象, MAX_CITY
#DIM カウンタ, 1
VARSET 対象
VARSET カウンタ

;シャッフル用の配列を作成する
FOR LOCAL, 0, MAX_CITY
	IF CITY_TYPE:LOCAL == 1
		BREAK
	ENDIF
	IF ARG:0 || (!ARG:0 && CITY_OWNER:LOCAL == CFLAG:MASTER:1)
		対象:カウンタ = LOCAL
		カウンタ ++
	ENDIF
NEXT
IF カウンタ > 0
	CALL FISHER_YATES_SHAFFLE(カウンタ)
	RETURN 対象:(SHAFFLE_ARRAY:0)
ELSE
	RETURN -1
ENDIF

;デイリーイベントにおいて、ランダムに対象国家を選出する
;RESULT 選出された対象国家
@DAILY_EVENT_RAND_COUNTRYSELECT
#DIM 対象, MAX_COUNTRY
#DIM カウンタ
VARSET 対象
VARSET カウンタ

;シャッフル用の配列を作成する
FOR LOCAL, 0, MAX_COUNTRY
	IF IS_COUNTRY(LOCAL)
		対象:カウンタ = LOCAL
		カウンタ ++
	ENDIF
NEXT
IF カウンタ > 0
	CALL FISHER_YATES_SHAFFLE(カウンタ)
	RETURN 対象:(SHAFFLE_ARRAY:0)
ELSE
	RETURN -1
ENDIF