@DRUG_ADDICT
#DIM 人数
#DIM LCOUNT
#DIM 選出閾値
#DIM 結果
VARSET LOCAL, -1
VARSET 人数
FOR LCOUNT, 0, CHARANUM
	IF CFLAG:LCOUNT:所属 == CFLAG:MASTER:所属 && !CFLAG:LCOUNT:捕虜先 && IS_FEMALE(LCOUNT)
		SELECTCASE CFLAG:(LCOUNT):薬物依存
			CASE IS >= 300
				選出閾値 = 50
			CASE IS >= 200
				選出閾値 = 30
			CASE IS >= 100
				選出閾値 = 10
			CASEELSE
				選出閾値 = 0
		ENDSELECT
		IF TALENT:LCOUNT:薬物依存 || RAND:100 < 選出閾値 
			LOCAL:人数 =LCOUNT
			人数++
		ENDIF
	ENDIF
NEXT
IF 人数 == 0
	RETURN 0
ELSE
	CALL FISHER_YATES_SHAFFLE(人数)
	結果 = LOCAL:(SHAFFLE_ARRAY:0)
	DRAWLINE
	PRINTFORMW %ANAME(結果)%は、薬物の禁断症状に苦しんでいるようだ……
	SELECTCASE RAND:11
		CASE 0
			PRINTFORML %ANAME(結果)%は症状に堪えかね、怪しげな薬売りにわたりをつけたようだ
			PRINTFORML 薬売りは薬と引き換えに、%ANAME(結果)%の肉体を要求した
			PRINTFORML 薬のためなら、己の貞操などどうでもよかった。%ANAME(結果)%は自ら服を脱ぎ、薬売りと交わった……
			PRINTFORML 白濁まみれでベッドに横たわる%ANAME(結果)%に薬を投げ渡し、男は立ち去った
		CASE 1
			PRINTFORML %ANAME(結果)%は薬代を稼ぐため、娼婦として働いたようだ
			PRINTFORML %ANAME(結果)%のセックスの技術は、客を大変満足させたようだ
			PRINTFORML 何人もの男が%ANAME(結果)%を買っては、その肉穴に精を注いでいった
			PRINTFORML 丸一日汚されて得たなけなしの金で、%ANAME(結果)%は僅かな薬を手に入れたようだ……
		CASE 2
			PRINTFORML %ANAME(結果)%はガラの悪い男達に輪姦されている
			PRINTFORML 薬と引き換えに肉体を求められたのだ
			PRINTFORML 男達はゲラゲラ笑いながら、%ANAME(結果)%のあらゆる穴に次々と肉棒をねじ込んでいく
			PRINTFORML やがて、白濁にまみれ呆然とする%ANAME(結果)%に、男達はクズ薬を放り投げて立ち去った……
		CASE 3
			PRINTFORML %ANAME(結果)%はえへらえへらと笑いながら、男達に輪姦されている
			PRINTFORML スラムの悪漢たちが%ANAME(結果)%に怪しげな薬品を売り、その場で使ったのだ
			PRINTFORML 犯されているというのに、%ANAME(結果)%は幸せそうに、彼らの上で自ら腰を振る
			PRINTFORML 男が膣内に子種をぶちまけると、%ANAME(結果)%はたまらないというように背を反らし絶頂した……
		CASE 4
			PRINTFORML %ANAME(結果)%は薬代を稼ぐため、行きずりの男に身体を売ったようだ
			PRINTFORML 宿に連れ込まれると、%ANAME(結果)%は自ら積極的に男のモノをしゃぶり、扱き、彼の上で腰を振る
			PRINTFORML 片手に余る回数男を射精させたこともあり、男の金払いは大変良かった……
			PRINTFORML %ANAME(結果)%は稼いだ金で、僅かな薬を手に入れたようだ……
		CASE 5
			PRINTFORML %ANAME(結果)%は薬代を稼ぐため、行きずりの男に身体を売ろうとした
			PRINTFORML ……が、それが地元のギャングの目に触れ、%ANAME(結果)%は拉致されてしまった！
			PRINTFORML そんなに薬が欲しいならくれてやるよと、彼らは自分たちのアジトで、%ANAME(結果)%に怪しげな薬を打ち込んだ
			PRINTFORML すぐ薬が回りえへえへと笑い始めた%ANAME(結果)%を、男達は次々と犯していった……
			PRINTFORML %ANAME(結果)%を散々輪姦した後、彼らは白濁まみれの%ANAME(結果)%を路地裏に放り捨てた……
			PRINTFORML 怪しげな薬の効果で、%ANAME(結果)%の中毒症状はさらにひどくなってしまったようだ
		CASE 6
			PRINTFORML 薬物の効果でおかしくなってしまった%ANAME(結果)%は、浮浪者に声をかけたようだ
			PRINTFORML 恥垢まみれの肉棒を自らしゃぶりあげ、彼らに自ら脚を開き、性交をねだる
			PRINTFORML 子宮をずこずこと突かれるたび、意識ごと吹き飛びそうなほどの快感が%ANAME(結果)%を襲った……
			PRINTFORML 男が立ち去った後には、何発と射精された白濁を肉穴から垂れ流す%ANAME(結果)%だけが残されていた……
		CASE 7
			PRINTFORML 薬代を稼ぐため、%ANAME(結果)%はストリップショーに出演したようだ
			PRINTFORML 卑猥な衣装を着てステージ上に躍り出、乳房や秘部を強調するダンスを踊る
			PRINTFORML 衣装を脱ぎ捨てると、露わになった濡れそぼつ雌穴を、ぐちょぐちょと掻き回していく
			PRINTFORML やがて興奮した客がステージに昇ると、ストリップショーはまな板ショーへ演目を変更した……
			PRINTFORML 興行の報酬に、%ANAME(結果)%はたっぷりと薬をもらってきたようだ
		CASE 8
			PRINTFORML 路地裏に店を構える怪しげな商人を、%ANAME(結果)%は訪ねたようだ
			PRINTFORML 気のいいことに、商人はその場で、無料で%ANAME(結果)%に薬を振る舞った
			PRINTFORML 商人は早速薬を使いトリップした%ANAME(結果)%を押し倒し、服を剥ぎ取り、犯し始める
			PRINTFORML レイプされているというのに、薬の効能が%ANAME(結果)%をヨガり狂わせ、膣内射精をねだらせる
			PRINTFORML 結局彼女が退店したのは、片手で足りない数の精を膣内に吐き出されてからだった……
			PRINTFORML 犯されたというのに、彼女は、薬のためにあの店に通うことを考えていた……
		CASE 9
			PRINTFORML 薬を求め、%ANAME(結果)%は路地裏の怪しげな商人を訪ねたようだ
			PRINTFORML 金がないことを伝えると、商人はセックスと引き換えに薬を売ってやると%ANAME(結果)%に告げる
			PRINTFORML 薬のためならと、%ANAME(結果)%は自ら服を脱ぎ、壁に手をつき彼に尻を突き出した
			PRINTFORML 商人は%ANAME(結果)%のことを嘲笑いながら、彼女の肉穴にペニスをねじ込んだ……
			PRINTFORML 路地裏に、女の嬌声が響き渡る……
			PRINTFORML %ANAME(結果)%が薬を手にしたのは、大量の白濁が肉穴に流し込まれた後のことだった
		CASE 10
			PRINTFORML だらしのないアヘ顔を晒しながら、%ANAME(結果)%は男達に輪姦されてる
			PRINTFORML 怪しげな男に薬を打ってもらったまではいいが、トリップしているところを別の男達に売られたのだ
			PRINTFORML 口を、尻を、雌穴に肉棒をねじ込まれ、抽送されるたび、%ANAME(結果)%の頭に強烈な快楽が走る……
			PRINTFORML ことが終わった後、薬売りの男は、白濁にまみれ倒れ伏す%ANAME(結果)%に、礼だといって小銭を放り投げた……
			PRINTFORM 金
			SETCOLOR COLOR("CAUTION")
			PRINTFORM 1
			RESETCOLOR
			PRINTFORML を手に入れた
	ENDSELECT
	PRINTFORMW
	;好感度と従属度を失っていく
	CFLAG:(結果):好感度 = MAX(CFLAG:(結果):好感度 - MAX(CFLAG:(結果):好感度 * 3 / 10, 200) , 0)
	CFLAG:(結果):従属度 = MAX(CFLAG:(結果):従属度 - MAX(CFLAG:(結果):従属度 * 3 / 10, 200) , 0)
	;性処理と同等の経験を取得させる
	LOCAL:3 = 0
	LOCAL:3 += MAX(ABL:(結果):Ｃ感 - 1, 0)
	LOCAL:3 += MAX(ABL:(結果):Ｖ感 - 1, 0) * 3
	LOCAL:3 += MAX(ABL:(結果):Ａ感 - 1, 0) * 3
	LOCAL:3 += MAX(ABL:(結果):Ｂ感 - 1, 0)
	LOCAL:3 += MAX(ABL:(結果):Ｍ感 - 1, 0) / 2
	LOCAL:3 = LOCAL:3 * (ABL:(結果):欲望 + 2) / 2
		IF PENIS(結果)
		EXP:(結果):Ｃ感経験値 += ABL:(結果):Ｃ感 + 1 + RAND:3
		EXP:(結果):Ａ感経験値 += ABL:(結果):Ａ感 * 30 + 20 + RAND:16
	ELSE
		EXP:(結果):Ｃ感経験値 += ABL:(結果):Ｃ感 * 5 + 5 + RAND:11
		EXP:(結果):Ｖ感経験値 += ABL:(結果):Ｖ感 * 20 + 15 + RAND:11
		EXP:(結果):Ａ感経験値 += ABL:(結果):Ａ感 * 20 + 15 + RAND:11
		ENDIF
	EXP:(結果):Ｂ感経験値 += ABL:(結果):Ｂ感 * 4 + 4 + RAND:9
	EXP:(結果):Ｍ感経験値 += ABL:(結果):Ｍ感 * 4 + 4 + RAND:9
	EXP:(結果):欲望経験値 += ABL:(結果):欲望 * 3 + 2 + LOCAL:3 + RAND:7
	EXP:(結果):奉仕経験値 += ABL:(結果):奉仕 * 2 + 5 + RAND:11
	EXP:(結果):性交経験値 += ABL:(結果):性交 * 5 + 15 + RAND:11
	EXP:(結果):性技経験値 += ABL:(結果):性技 + 2 + RAND:4
	IF IS_MALE(結果)
		EXP:(結果):ＢＬ経験値 += 25 + RAND:11
	ENDIF
	EXP:(結果):精愛経験値 += ABL:(結果):精愛 * 10 + 30 + RAND:21
	IF PENIS(結果)
		EXP:(結果):射精経験値 += ABL:(結果):射精 * 10 + 30 + RAND:21
	ENDIF
	CFLAG:(結果):薬物依存 += RAND(50, 100)
	EXP:(結果):キス経験 += 2 + RAND:8
	EXP:(結果):口淫経験 += 3 + RAND:10
	EXP:(結果):絶頂経験 += LOCAL:3 * (60 + RAND:81) / 100
	EXP:(結果):輪姦経験 += 3 + RAND(2, MAX(3, MIN(8, ABL:(結果):欲望)))
	;中出しと妊娠判定
	IF CONFIG:1 == 0 && (VAGINA(結果) || TALENT:(結果):孕み可能)
		FOR LOCAL:1, 440, 480
			TCVAR:(結果):(LOCAL:1) = 0
		NEXT
		CALL RECORD_INJECTION(結果, -1, 3)
		CALL CHECK_PREGNANT(結果)
	ENDIF
	;能力上昇メッセ
	CALL TRAIN_AUTO_ABLUP(結果, 0)
	;処女とキス未経験を失う
	IF TALENT:(結果):キス未経験
		IF RAND:4
			;ペニスへのキス
			CALL KISS_COMMON(結果, -1, 1, 0, 0)
		ENDIF
		;唇へのキス
		CALL KISS_COMMON(結果, -1, 0, 0, 0)
		SETCOLOR COLOR_CAUTION
		PRINTFORML %ANAME(結果)%は<キス未経験>を失った…
		RESETCOLOR
	ENDIF
	IF TALENT:(結果):処女 && VAGINA(結果)
		SETCOLOR COLOR_CAUTION
		PRINTFORML %ANAME(結果)%は<処女>を失った…
		RESETCOLOR
		;処女を捧げた相手を野盗に設定
		CFLAG:(結果):41 = -1
		TALENT:(結果):処女 = 0
	ENDIF
ENDIF