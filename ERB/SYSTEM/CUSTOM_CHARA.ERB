;---------------------------------------
;カスタムキャラ用メニュー
;---------------------------------------
@CUSTOM_CHARA_MENU
#DIM 人数
#DIM 対象
#DIM FIRST_LINE

LOADGLOBAL
FIRST_LINE = LINECOUNT

DRAWLINE
PRINTFORML カスタムキャラ管理画面
DRAWLINE

人数 = 0
FOR LOCAL, 0, MAX_CUSTOM_CHARA
	IF CUSTOM_EXISTS(LOCAL)
		PRINTBUTTON @"[%CUSTOM_NAME:LOCAL:0%]", LOCAL
	ELSE
		PRINTBUTTON "[新規作成]", LOCAL
	ENDIF
	PRINTL
NEXT
DRAWLINE
PRINTBUTTON "[終了]", 99

INPUT 

IF RESULT == 99
	DELALLCHARA
	RETURN
ELSEIF INRANGE(RESULT, 0, MAX_CUSTOM_CHARA)
	IF CUSTOM_EXISTS(RESULT)
		CALL MODIFY_CUSTOM_DATA
	ELSE
		CALL CREATE_CUSTOM(RESULT)
	ENDIF
ENDIF
CLEARLINE FIRST_LINE - LINECOUNT
RESTART

;---------------------------------------
;カスタムキャラの変更・削除
;---------------------------------------
@MODIFY_CUSTOM_DATA(番号)
#DIM 番号
#DIM 対象

ADDVOIDCHARA
対象 = CHARANUM - 1
CALL APPLY_CUSTOM_DATA(対象, 番号)

CONFIG:6 = 1

DRAWLINE
CALL SHOW_INFO(対象)
DRAWLINE

CONFIG:6 = LOCAL:0

PRINTBUTTON "[修正]", 0
PRINT    
PRINTBUTTON " [削除]", 1
PRINTL 
PRINTBUTTON " [戻る]", 9
PRINTL
$INPUT_LOOP 
INPUT
SELECTCASE RESULT
	CASE 0
		CALL CREATE_CUSTOM(番号, 1)
		RETURN
	CASE 1
		CALL DELETE_CUSTOM(番号)
		SAVEGLOBAL
		RETURN
	CASE 9
		DELALLCHARA
		RETURN
ENDSELECT
GOTO INPUT_LOOP

;---------------------------------------
;カスタムキャラの存在判定
;---------------------------------------
@CUSTOM_EXISTS(ARG:0)
#FUNCTION

RETURNF CUSTOM_MAXBASE:ARG:0 > 0
