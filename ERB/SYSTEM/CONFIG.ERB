;コンフィグ画面とゲーム設定に関する処理

;-------------------------------------------------
;コンフィグの初期設定
;-------------------------------------------------
@INIT_CONFIG
CONFIG:3 = 50
CONFIG:4 = 30
CONFIG:6 = 1
CONFIG:9 = 1
CONFIG:10 = 1
CONFIG:80 = 2

;継続フィルタの初期設定
VARSET EQUIP_FILTER, 1
VARSET EQUIP_FILTER, 0, 30, 50
EQUIP_FILTER:6 = 0
EQUIP_FILTER:7 = 0
EQUIP_FILTER:61 = 0
EQUIP_FILTER:62 = 0
EQUIP_FILTER:63 = 0
EQUIP_FILTER:64 = 0
EQUIP_FILTER:65 = 0
EQUIP_FILTER:66 = 0
EQUIP_FILTER:101 = 0
EQUIP_FILTER:102 = 0
EQUIP_FILTER:105 = 0
VARSET EQUIP_FILTER, 0, 200, 209
EQUIP_FILTER:210 = 0
EQUIP_FILTER:211 = 0

;SLG部分のコンフィグの初期設定
CALL INIT_CONFIG_SLG

;-------------------------------------------------
;コンフィグ画面の処理
;-------------------------------------------------
@SHOW_CONFIG
DRAWLINE
PRINTL ★★各種設定やデータの操作を行います★★
DRAWLINE
PRINTBUTTON "  0[ＳＬＧパートに関する設定]", 0
PRINTL
PRINTBUTTON "  1[  交流パートに関する設定]", 1
PRINTL 
PRINTBUTTON "  5[  特殊な性癖に関する設定]", 5
PRINTL 
PRINTBUTTON "  6[  デイリーイベントの設定]", 6
PRINTL 
PRINTBUTTON " 10[        コマンドフィルタ]", 10
PRINTL 
PRINTL 
PRINTBUTTON " 80[        現在の設定を保存]", 80
PRINTL 
PRINTBUTTON " 81[  保存した設定の読み込み]", 81
PRINTL 
DRAWLINE
PRINTBUTTON " 85[データ操作]", 85
PRINTL 
DRAWLINE
PRINTBUTTON " 99[      戻る]", 99
PRINTL 
$INPUT_LOOP
INPUT

IF RESULT == 99
	RETURN
ELSEIF RESULT == 0
	;→(SLG\CONFIG_SLG.ERB)
	CALL CONFIG_SLG
ELSEIF RESULT == 1
	CALL CONFIG_OTHERS
ELSEIF RESULT == 5
	;特殊設定
	CALL CONFIG_OTHERS_SP
ELSEIF RESULT == 6
	;イベント設定
	CALL CONFIG_EVENT_DAILY
ELSEIF RESULT == 10
	CALL CONFIG_COM_FILTER
ELSEIF RESULT == 80
	CALL CONFIG_SAVE
ELSEIF RESULT == 81
	CALL CONFIG_LOAD
ELSEIF RESULT == 85
	CALL CONFIG_DATA_EDIT
ELSE
	GOTO INPUT_LOOP
ENDIF
RESTART

;-------------------------------------------------
;設定の保存
;-------------------------------------------------
@CONFIG_SAVE
DRAWLINE
PRINTL どの番号に保存しますか？
DRAWLINE
FOR LOCAL:0, 0, 5
	PRINTBUTTON @" {LOCAL:0}[設定{LOCAL:0}]", LOCAL:0 
	IF G_CONFIG_NAME:(LOCAL:0) == ""
		SETCOLOR COLOR("選択不可")
		PRINTL  ------
		RESETCOLOR
	ELSE
		PRINTFORML  %G_CONFIG_NAME:(LOCAL:0)%
	ENDIF
NEXT
DRAWLINE
PRINTBUTTON " 9[ 戻る]", 9
PRINTL 

$INPUT_LOOP
INPUT

IF RESULT == 9
	RETURN
ELSEIF RESULT >= 0 && RESULT < 5
	LOCAL:5 = RESULT

	PRINTFORML {LOCAL:5}番に保存します
	PRINTFORML 設定データの名前を入力して下さい
	PRINTFORML (何も入力しないと「設定{LOCAL:5}」になります)

	$INPUT_LOOP_2
	INPUTS

	IF RESULTS == ""
		G_CONFIG_NAME:(LOCAL:5) = 設定{LOCAL:5}
	ELSE
		G_CONFIG_NAME:(LOCAL:5) = %RESULTS%
	ENDIF

	VARSET G_FILTER, 0

	FOR LOCAL:0, 0, 1000
		LOCAL:2 = LOCAL:0 / 50
		LOCAL:3 = LOCAL:0 % 50
		G_CONFIG:(LOCAL:5):(LOCAL:0) = CONFIG:(LOCAL:0)
		G_DCONFIG:(LOCAL:5):(LOCAL:0) = DCONFIG:(LOCAL:0)
		G_FILTER:(LOCAL:5):(LOCAL:2) |= (COM_FILTER:(LOCAL:0) != 0) << LOCAL:3
		G_FILTER:(LOCAL:5):(LOCAL:2 + 20) |= (EQUIP_FILTER:(LOCAL:0) != 0) << LOCAL:3
	NEXT

	;グローバル変数を保存
	SAVEGLOBAL
	RETURN
ENDIF
GOTO INPUT_LOOP

;-------------------------------------------------
;設定の読み込み
;-------------------------------------------------
@CONFIG_LOAD
DRAWLINE
PRINTL どの設定を読み込みますか？
DRAWLINE
FOR LOCAL:0, 0, 5
	IF G_CONFIG_NAME:(LOCAL:0) == ""
		SETCOLOR COLOR("選択不可")
		PRINTPLAINFORM  {LOCAL:0}[設定{LOCAL:0}] ------
		RESETCOLOR
	ELSE
		PRINTBUTTON @" {LOCAL:0}[設定{LOCAL:0}]", LOCAL:0
		PRINTFORM  %G_CONFIG_NAME:(LOCAL:0)%
	ENDIF
	PRINTL 
NEXT
DRAWLINE
PRINTBUTTON " 9[ 戻る]", 9
PRINTL 

$INPUT_LOOP
INPUT

IF RESULT == 9
	RETURN
ELSEIF RESULT >= 0 && RESULT < 5
; && G_CONFIG_NAME:RESULT != ""
	LOCAL:5 = RESULT

	FOR LOCAL:0, 0, 1000
		LOCAL:2 = LOCAL:0 / 50
		LOCAL:3 = LOCAL:0 % 50
		CONFIG:(LOCAL:0) = G_CONFIG:(LOCAL:5):(LOCAL:0)
		DCONFIG:(LOCAL:0) = G_DCONFIG:(LOCAL:5):(LOCAL:0)
		COM_FILTER:(LOCAL:0) = (G_FILTER:(LOCAL:5):(LOCAL:2) >> LOCAL:3) & 1
		EQUIP_FILTER:(LOCAL:0) = (G_FILTER:(LOCAL:5):(LOCAL:2 + 20) >> LOCAL:3) & 1
	NEXT

	PRINTFORMW {LOCAL:5}番の設定を読み込みました
	RETURN
ENDIF
GOTO INPUT_LOOP

;-------------------------------------------------
;その他の部分に関する設定
;-------------------------------------------------
@CONFIG_OTHERS
DRAWLINE
PRINTL ●その他の部分に関する設定●
DRAWLINE

LOCALS:0 = ターン終了時の交流イベント
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 0[変更]", 0
PRINT  
SELECTCASE CONFIG:0
	CASE 0
		PRINT 許可
	CASE 1
		PRINT 抑制
ENDSELECT
PRINTL 

LOCALS:0 = 妊娠の有無
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 1[変更]", 1
PRINT  
SELECTCASE CONFIG:1
	CASE 0
		PRINT 妊娠する
	CASE 1
		PRINT 妊娠しない
ENDSELECT
PRINTL 

IF CONFIG:1 == 0
	LOCALS:0 = 交流イベントによる妊娠
	PRINTFORM %LOCALS:0, 28, RIGHT% -
	PRINTBUTTON " 2[変更]", 2
	PRINT  
	SELECTCASE CONFIG:2
		CASE 0
			PRINT 妊娠する
		CASE 1
			PRINT 妊娠しない
	ENDSELECT
	PRINTL 
ENDIF

LOCALS:0 = ランダムキャラの男性率
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 3[変更]", 3
PRINT  
PRINTFORM {CONFIG:3}\%
PRINTL 

LOCALS:0 = 子供の男性率
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 4[変更]", 4
PRINT  
PRINTFORM {CONFIG:4}\%
PRINTL 

LOCALS:0 = 子供の成長
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 5[変更]", 5
PRINT  
SELECTCASE CONFIG:5
	CASE 0
		PRINT 成長する
	CASE 1
		PRINT 成長しない
ENDSELECT
PRINTL 

LOCALS:0 = 外見に関する詳細の表示
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 6[変更]", 6
PRINT  
SELECTCASE CONFIG:6
	CASE 0
		PRINT 表示しない
	CASE 1
		PRINT 表示する
ENDSELECT
PRINTL 

LOCALS:0 = 捕虜の扱い設定
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 7[変更]", 7
PRINT  
SELECTCASE CONFIG:7
	CASE 0
		PRINT 拠点フェイズ終了時に選択
	CASE 1
		PRINT 拠点フェイズのメニューから選択
ENDSELECT
PRINTL 

LOCALS:0 = 男主人公への逆調教の傾向
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 8[変更]", 8
PRINT  
SELECTCASE CONFIG:8
	CASE 0
		PRINT 搾り取る
	CASE 1
		PRINT 射精管理
ENDSELECT
PRINTL 

LOCALS:0 = 潮吹きの有無
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON " 9[変更]", 9
PRINT  
SELECTCASE CONFIG:9
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効
ENDSELECT
PRINTL 

LOCALS:0 = ファーストキスの表示
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "10[変更]", 10
PRINT  
SELECTCASE CONFIG:10
	CASE 0
		PRINT 唇のみ
	CASE 1
		PRINT ペニスや足なども対象
ENDSELECT
PRINTL 

LOCALS:0 = 男の娘・男性の潤滑上昇
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "11[変更]", 11
PRINT  
SELECTCASE CONFIG:11
	CASE 0
		PRINT 自然には濡れない
	CASE 1
		PRINT 男の娘のみ濡れる
	CASE 2
		PRINT 男の娘・男性ともに濡れる
ENDSELECT
PRINTL 

LOCALS:0 = 男の娘の妊娠
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "12[変更]", 12
PRINT  
SELECTCASE CONFIG:12
	CASE 0
		PRINT 特殊なアイテムが必要(男性と同様)
	CASE 1
		PRINT 常に可能
ENDSELECT
PRINTL 

LOCALS:0 = 済マークの使用
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "13[変更]", 13
PRINT  
SELECTCASE CONFIG:13
	CASE 0
		PRINT 行動済みキャラを済マーク点灯で表示（左側表示）
	CASE 2
		PRINT 行動済みキャラを済マーク点灯で表示（右側表示）
	CASE 1
		PRINT 使用しない
ENDSELECT
PRINTL 

LOCALS:0 = ピアスの表示
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "14[変更]", 14
PRINT  
SELECTCASE CONFIG:14
	CASE 0
		PRINT 表示する
		COM_FILTER:91 = 0
	CASE 2
		PRINT 表示しない
	CASE 1
		PRINT コマンドも表示しない
		COM_FILTER:91 = 1
ENDSELECT
PRINTL 

LOCALS:0 = 陰毛状態の表示
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "15[変更]", 15
PRINT  
SELECTCASE CONFIG:15
	CASE 0
		PRINT 表示する
		COM_FILTER:113 = 0
	CASE 2
		PRINT 表示しない
	CASE 1
		PRINT コマンドも表示しない
		COM_FILTER:113 = 1
ENDSELECT
PRINTL 

LOCALS:0 = タトゥの表示
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "16[変更]", 16
PRINT  
SELECTCASE CONFIG:16
	CASE 0
		PRINT 表示する
		COM_FILTER:92 = 0
	CASE 2
		PRINT 表示しない
	CASE 1
		PRINT コマンドも表示しない
		COM_FILTER:92 = 1
ENDSELECT
PRINTL 

LOCALS:0 = 捕虜あなた逆調教の参加者
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "17[変更]", 17
PRINT  
SELECTCASE CONFIG:17
	CASE 0
		PRINT 全員許可
	CASE 1
		PRINT 面識のある相手のみ
ENDSELECT
PRINTL 
PRINTL 

PRINTL 

LOCALS:0 = 固定キャラの口上の表示
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "40[変更]", 40
PRINT  
SELECTCASE CONFIG:40
	CASE 0
		PRINT 表示する
	CASE 1
		PRINT 表示しない
ENDSELECT
PRINTL 

LOCALS:0 = 汎用キャラの口上の表示
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "41[変更]", 41
PRINT  
SELECTCASE CONFIG:41
	CASE 0
		PRINT 表示する
	CASE 1
		PRINT 表示しない
ENDSELECT
PRINTL 

LOCALS:0 = 調教終了後性癖レベル自動上昇
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTBUTTON "42[変更]", 42
PRINT  
SELECTCASE CONFIG:42
	CASE 0
		PRINT しない
	CASE 1
		PRINT する
ENDSELECT
PRINTL 
PRINTL 

LOCALS:0 = 外来人の性別
PRINTFORM %LOCALS:0, 28, RIGHT% -
PRINTFORM 対男性:  %TOSTR_SEX((CONFIG:50 >> 0) & 0b1111), 6, LEFT% 
PRINTBUTTON "500[変更]", 500
PRINTFORM       対女性:  %TOSTR_SEX((CONFIG:50 >> 4) & 0b1111), 6, LEFT% 
PRINTBUTTON "501[変更]", 501
PRINTL 
PRINTFORM %TOSTR_SPACE(30)%対女双:  %TOSTR_SEX((CONFIG:50 >> 8) & 0b1111), 6, LEFT% 
PRINTBUTTON "502[変更]", 502
PRINTFORM       対男双:  %TOSTR_SEX((CONFIG:50 >> 12) & 0b1111), 6, LEFT% 
PRINTBUTTON "503[変更]", 503
PRINTL 
PRINTFORM %TOSTR_SPACE(30)%対男の娘:%TOSTR_SEX((CONFIG:50 >> 16) & 0b1111), 6, LEFT% 
PRINTBUTTON "504[変更]", 504
PRINTFORM       対男娘双:%TOSTR_SEX((CONFIG:50 >> 20) & 0b1111), 6, LEFT% 
PRINTBUTTON "505[変更]", 505
PRINTL 

DRAWLINE
PRINTBUTTON " 99[決定]", 99
PRINTL 

$INPUT_LOOP
INPUT

IF RESULT == 99
	RETURN
ELSEIF RESULT == 0
	CALL CONFIG_TOGGLE(0)
ELSEIF RESULT == 1
	CALL CONFIG_TOGGLE(1)
ELSEIF RESULT == 2 && CONFIG:1 == 0
	CALL CONFIG_TOGGLE(2)
ELSEIF RESULT == 3
	CONFIG:3 += 10
	IF CONFIG:3 > 100
		CONFIG:3 = 0
	ENDIF
ELSEIF RESULT == 4
	CONFIG:4 += 10
	IF CONFIG:4 > 100
		CONFIG:4 = 0
	ENDIF
ELSEIF RESULT == 5
	CALL CONFIG_TOGGLE(5)
ELSEIF RESULT == 6
	CALL CONFIG_TOGGLE(6)
ELSEIF RESULT == 7
	CALL CONFIG_TOGGLE(7)
ELSEIF RESULT == 8
	CALL CONFIG_TOGGLE(8)
ELSEIF RESULT == 9
	CALL CONFIG_TOGGLE(9)
ELSEIF RESULT == 10
	CALL CONFIG_TOGGLE(10)
ELSEIF RESULT == 11
	CONFIG:11 ++
	IF CONFIG:11 >= 3
		CONFIG:11 = 0
	ENDIF
ELSEIF RESULT == 12
	CALL CONFIG_TOGGLE(12)
ELSEIF RESULT == 13
	SELECTCASE CONFIG:13
		CASE 0
			CONFIG:13 = 2
		CASE 2
			CONFIG:13 = 1
		CASE 1
			CONFIG:13 = 0
	ENDSELECT
ELSEIF RESULT == 14
	SELECTCASE CONFIG:14
		CASE 0
			CONFIG:14 = 2
		CASE 2
			CONFIG:14 = 1
		CASE 1
			CONFIG:14 = 0
	ENDSELECT
ELSEIF RESULT == 15
	SELECTCASE CONFIG:15
		CASE 0
			CONFIG:15 = 2
		CASE 2
			CONFIG:15 = 1
		CASE 1
			CONFIG:15 = 0
	ENDSELECT
ELSEIF RESULT == 16
	SELECTCASE CONFIG:16
		CASE 0
			CONFIG:16 = 2
		CASE 2
			CONFIG:16 = 1
		CASE 1
			CONFIG:16 = 0
	ENDSELECT
ELSEIF RESULT == 17
	SELECTCASE CONFIG:17
		CASE 0
			CONFIG:17 = 1
		CASE 1
			CONFIG:17 = 0
	ENDSELECT
ELSEIF RESULT == 40
	CALL CONFIG_TOGGLE(40)
ELSEIF RESULT == 41
	CALL CONFIG_TOGGLE(41)
ELSEIF RESULT == 42
	CALL CONFIG_TOGGLE(42)
ELSEIF RESULT >= 500 && RESULT <= 505
	LOCAL:1 = (RESULT - 500) * 4
	LOCAL:0 = ((CONFIG:50 >> LOCAL:1) & 0b1111)
	LOCAL:0 ++ 
	IF LOCAL:0 >= 6
		LOCAL:0 = 0
	ENDIF
	CONFIG:50 = ((CONFIG:50 & ~(0b1111 << LOCAL:1)) | (LOCAL:0 << LOCAL:1))
ELSE
	GOTO INPUT_LOOP
ENDIF
RESTART

;-------------------------------------------------
;特殊設定(主に好き嫌いが分かれやすい要素の設定)
;-------------------------------------------------
@CONFIG_OTHERS_SP
DRAWLINE
PRINTL ●特殊設定●
DRAWLINE
PRINTL ◇NTR系◇

LOCALS:0 = 霖之助と女性士官の関係構築
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "70[変更]", 70
PRINT  
SELECTCASE CONFIG:70
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効
ENDSELECT
PRINTL 

;タチ役を藍以外にする		CONFIG:88　にキャラIDを入れて設定
LOCALS:0 = タチ役設定
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "88[変更]", 88
PRINT  
PRINTFORM %ANAME(CONFIG:88)%
PRINTL 


LOCALS:0 = %ANAME(CONFIG:88)%による女性士官への手出し
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "71[変更]", 71
PRINT  
SELECTCASE CONFIG:71
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効／君主でも淑女
	CASE 2
		PRINT 有効／君主なら好き勝手
ENDSELECT
PRINTL 

IF CONFIG:71 == 2
	LOCALS:0 = 主人公が暴君化した%ANAME(CONFIG:88)%の餌食に
	PRINTFORM %LOCALS:0, 50, RIGHT% -
	PRINTBUTTON "79[変更]", 79
	PRINT  
	SELECTCASE CONFIG:79
		CASE 0
			PRINT ならない
		CASE 1
			PRINT なる(女性・女双のみ対応)
		CASE 2
			PRINT なる(性別問わず対応)
	ENDSELECT
	PRINTL 
ENDIF

IF CONFIG:70 || CONFIG:71
	LOCALS:0 = 親密な女性士官を放置したとき
	PRINTFORM %LOCALS:0, 50, RIGHT% -
	PRINTBUTTON "72[変更]", 72
	PRINT  
	SELECTCASE CONFIG:72
		CASE 0
			PRINT 何も起きない
		CASE 1
			PRINTFORM 霖之助や%ANAME(CONFIG:88)%になびく
	ENDSELECT
	PRINTL 

	LOCALS:0 = 霖之助・%ANAME(CONFIG:88)%に惹かれかけた時の警告文
	PRINTFORM %LOCALS:0, 50, RIGHT% -
	PRINTBUTTON "82[変更]", 82
	PRINT  
	SELECTCASE CONFIG:82
		CASE 0
			PRINT 表示しない
		CASE 1
			PRINT 恋慕・恋人のみ表示する
		CASE 2
			PRINT 全て表示する
	ENDSELECT
	PRINTL 

	LOCALS:0 = 霖之助・%ANAME(CONFIG:88)%が手を付ける範囲の制限
	PRINTFORM %LOCALS:0, 50, RIGHT% -
	PRINTBUTTON "83[変更]", 83
	PRINT  
	SELECTCASE CONFIG:83
		CASE 0
			PRINT 無制限
		CASE 1
			PRINT 主人公と面識のある士官
		CASE 2
			PRINT 恋慕・服従を持つ士官
	ENDSELECT
	PRINTL 

	IF CONFIG:71 == 2
		LOCALS:0 = 暴君%ANAME(CONFIG:88)%がつまみ食いする範囲の制限
		PRINTFORM %LOCALS:0, 50, RIGHT% -
		PRINTBUTTON "84[変更]", 84
		PRINT  
		SELECTCASE CONFIG:84
			CASE 0
				PRINT 無制限
			CASE 1
				PRINT 主人公と面識のある士官
			CASE 2
				PRINT 恋慕・服従を持つ士官
		ENDSELECT
		PRINTL 
	ENDIF

	LOCALS:0 = 霖之助や%ANAME(CONFIG:88)%の情事を覗き見るイベント
	PRINTFORM %LOCALS:0, 50, RIGHT% -
	PRINTBUTTON "73[変更]", 73
	PRINT  
	SELECTCASE CONFIG:73
		CASE 0
			PRINT 無効
		CASE 1
			PRINT 有効
	ENDSELECT
	PRINTL 

	IF CONFIG:73 == 1
		LOCALS:0 = └→頻度の詳細設定
		PRINTFORM %LOCALS:0, 50, RIGHT% -
		PRINTBUTTON "77[変更]", 77
		PRINT  
		SELECTCASE CONFIG:77
			CASE 0
				PRINT 普通
			CASE 1
				PRINT 多い
			CASE 2
				PRINT 非常に多い
			CASE 3
				PRINT 3ターン毎
			CASE 4
				PRINT 2ターン毎
			CASE 5
				PRINT 毎ターン
		ENDSELECT
		PRINTL 

		LOCALS:0 = └→%ANAME(CONFIG:88)%によるレズＳＭパッチ(地の文追加)
		PRINTFORM %LOCALS:0, 50, RIGHT% -
		PRINTBUTTON "78[変更]", 78
		PRINT  
		SELECTCASE CONFIG:78
			CASE 0
				PRINT 無効
			CASE 1
				PRINT 有効
		ENDSELECT
		PRINTL 

		LOCALS:0 = └→霖之助寝取られ覗きパッチ(地の文変更)
		PRINTFORM %LOCALS:0, 50, RIGHT% -
		PRINTBUTTON "85[変更]", 85
		PRINT  
		SELECTCASE CONFIG:85
			CASE 0
				PRINT 無効(短め・情景重視)
			CASE 1
				PRINT 有効(長め・心情重視・NTR分強化)
		ENDSELECT
		PRINTL 
	ENDIF

	LOCALS:0 = 霖之助とのラブパワーによる能力強化
	PRINTFORM %LOCALS:0, 50, RIGHT% -
	PRINTBUTTON "74[変更]", 74
	PRINT  
	SELECTCASE CONFIG:74
		CASE 0
			PRINT 無効
		CASE 1
			PRINT 有効
	ENDSELECT
	PRINTL 

	LOCALS:0 = %ANAME(CONFIG:88)%とのラブパワーによる能力強化
	PRINTFORM %LOCALS:0, 50, RIGHT% -
	PRINTBUTTON "75[変更]", 75
	PRINT  
	SELECTCASE CONFIG:75
		CASE 0
			PRINT 無効
		CASE 1
			PRINT 有効
	ENDSELECT
	PRINTL 

	IF CONFIG:1 == 0
		LOCALS:0 = 女性士官が霖之助や%ANAME(CONFIG:88)%の子供を妊娠
		PRINTFORM %LOCALS:0, 50, RIGHT% -
		PRINTBUTTON "76[変更]", 76
		PRINT  
		SELECTCASE CONFIG:76
			CASE 0
				PRINT 無効
			CASE 1
				PRINT 有効
		ENDSELECT
		PRINTL 
	ENDIF
ENDIF

LOCALS:0 = 一部勢力による捕虜への調教
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "80[変更]", 80
PRINT  
SELECTCASE CONFIG:80
	CASE 0
		PRINT 発生しない
	CASE 1
		PRINT 女性・ふたなりのみ発生
	CASE 2
		PRINT 全て発生
ENDSELECT
PRINTL 

;LOCALS:0 = 外来勢力の烙印による能力強化
;PRINTFORM %LOCALS:0, 50, RIGHT% -
;PRINTBUTTON "86[変更]", 86
;PRINT  
;SELECTCASE CONFIG:86
;	CASE 0
;		PRINT しない
;	CASE 1
;		PRINT 強化（依存度を好感度とみなして計算します）
;	CASE 2
;		PRINT 大きく強化（「ちょっと」補正をかけて計算します……）
;ENDSELECT
;PRINTL 

LOCALS:0 = %ANAME(CONFIG:88)%による捕虜調教(君主限定)
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "81[変更]", 81
PRINT  
SELECTCASE CONFIG:81
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効／女性・ふたなりのみ
	CASE 2
		PRINT 有効／性別によらず対象
ENDSELECT
PRINTL 

LOCALS:0 = 慧音先生の保健体育(寺子屋)
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "87[変更]", 87
PRINT  
SELECTCASE CONFIG:87
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効
ENDSELECT
PRINTL 


DRAWLINE
PRINTL ◇スカ系◇
LOCALS:0 = 絶頂や尿意の限界によるおもらし
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "90[変更]", 90
PRINT  
SELECTCASE CONFIG:90
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効
ENDSELECT
PRINTL 

LOCALS:0 = 恐怖の異常上昇によるおもらし
PRINTFORM %LOCALS:0, 50, RIGHT% -
PRINTBUTTON "91[変更]", 91
PRINT  
SELECTCASE CONFIG:91
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効
ENDSELECT
PRINTL 

DRAWLINE
PRINTL ◇全般◇
LOCALS:0 = 特殊性癖イベント一括停止フィルタ
PRINTFORM %LOCALS:0, 49, RIGHT% -
PRINTBUTTON "200[変更]", 200
PRINT  
SELECTCASE CONFIG:200
	CASE 0
		PRINT 無効
	CASE 1
		PRINT 有効（付随する能力／経験変化も行われません）
ENDSELECT
PRINTL 



DRAWLINE
PRINTL [99] 決定

$INPUT_LOOP
INPUT

IF RESULT == 99
	RETURN
ELSEIF RESULT == 70
	CONFIG:70 ++
	IF CONFIG:70 >= 2
		CONFIG:70 = 0
	ENDIF
ELSEIF RESULT == 88
	PRINTFORML タチ役とするキャラの名前を入力して下さい(主人公、霖之助、既に<(タチ役)に恋慕>があるキャラは除外)
	INPUTS
	FOR LOCAL:0 , 1 , CHARANUM
		IF RESULTS == ANAME(LOCAL:0)
			IF LOCAL:0 == NAME_TO_CHARA("霖之助")
				CONTINUE
			ENDIF
			IF TALENT:(LOCAL:0):藍に恋慕
				PRINTW <(タチ役)に恋慕>の素質があるため設定できません
				BREAK
			ENDIF
			CONFIG:88 = LOCAL:0
			BREAK
		ENDIF
	NEXT
	SIF LOCAL:0 >= CHARANUM
		PRINTW 該当者が見つかりません
ELSEIF RESULT == 71
	CONFIG:71 ++
	IF CONFIG:71 >= 3
		CONFIG:71 = 0
	ENDIF
ELSEIF RESULT == 79 && CONFIG:71 == 2
	CONFIG:79 ++
	IF CONFIG:79 >= 3
		CONFIG:79 = 0
	ENDIF
ELSEIF RESULT == 72 && (CONFIG:70 || CONFIG:71)
	CONFIG:72 ++
	IF CONFIG:72 >= 2
		CONFIG:72 = 0
	ENDIF
ELSEIF RESULT == 73 && (CONFIG:70 || CONFIG:71)
	CONFIG:73 ++
	IF CONFIG:73 >= 2
		CONFIG:73 = 0
	ENDIF
ELSEIF RESULT == 77 && (CONFIG:70 || CONFIG:71) && CONFIG:73 == 1
	CONFIG:77 ++
	IF CONFIG:77 >= 6
		CONFIG:77 = 0
	ENDIF
ELSEIF RESULT == 78 && (CONFIG:70 || CONFIG:71) && CONFIG:73 == 1
	CONFIG:78 ++
	IF CONFIG:78 >= 2
		CONFIG:78 = 0
	ENDIF
ELSEIF RESULT == 74 && (CONFIG:70 || CONFIG:71)
	CONFIG:74 ++
	IF CONFIG:74 >= 2
		CONFIG:74 = 0
	ENDIF
ELSEIF RESULT == 75 && (CONFIG:70 || CONFIG:71)
	CONFIG:75 ++
	IF CONFIG:75 >= 2
		CONFIG:75 = 0
	ENDIF
ELSEIF RESULT == 76 && (CONFIG:70 || CONFIG:71) && CONFIG:1 == 0
	CONFIG:76 ++
	IF CONFIG:76 >= 2
		CONFIG:76 = 0
	ENDIF
ELSEIF RESULT == 80
	CONFIG:80 ++
	IF CONFIG:80 >= 3
		CONFIG:80 = 0
	ENDIF
ELSEIF RESULT == 81
	CONFIG:81 ++
	IF CONFIG:81 >= 3
		CONFIG:81 = 0
	ENDIF
ELSEIF RESULT == 82
	CONFIG:82 ++
	IF CONFIG:82 >= 3
		CONFIG:82 = 0
	ENDIF
ELSEIF RESULT == 83
	CONFIG:83 ++
	IF CONFIG:83 >= 3
		CONFIG:83 = 0
	ENDIF
ELSEIF RESULT == 84
	CONFIG:84 ++
	IF CONFIG:84 >= 3
		CONFIG:84 = 0
	ENDIF
ELSEIF RESULT == 85
	CONFIG:85 ++
	IF CONFIG:85 >= 2
		CONFIG:85 = 0
	ENDIF
ELSEIF RESULT == 86
	CONFIG:86 ++
	IF CONFIG:86 >= 3
		CONFIG:86 = 0
	ENDIF
ELSEIF RESULT == 87
	CONFIG:87 ++
	IF CONFIG:87 >= 2
		CONFIG:87 = 0
	ENDIF
ELSEIF RESULT == 90
	CONFIG:90 ++
	IF CONFIG:90 >= 2
		CONFIG:90 = 0
	ENDIF
ELSEIF RESULT == 91
	CONFIG:91 ++
	IF CONFIG:91 >= 2
		CONFIG:91 = 0
	ENDIF
ELSEIF RESULT == 200
	CONFIG:200 = !CONFIG:200

ELSE
	GOTO INPUT_LOOP
ENDIF
RESTART

;-------------------------------------------------
;コマンドフィルタ
;-------------------------------------------------
@CONFIG_COM_FILTER
;ページ数の計算
LOCAL:20 = 0
FOR LOCAL:0, 0, 1000
	IF TRAINNAME:(LOCAL:0) != ""
		LOCAL:20 ++
	ENDIF
NEXT
LOCAL:20 = (LOCAL:20 - 1) / 66 + 1
LOCAL:21 = 1

DRAWLINE
PRINTFORML かけすぎると逆調教で無限ループするかもしれんのできをつけてね
DRAWLINE
$SHOW_LOOP

;コマンドの表示
LOCAL:22 = 0
LOCAL:23 = (LOCAL:21 - 1) * 66
LOCAL:24 = LOCAL:21 * 66
LOCAL:25 = 0
LOCAL:26 = 6
FOR LOCAL:0, 0, 1000
	IF TRAINNAME:(LOCAL:0) != ""
		IF LOCAL:22 >= LOCAL:23 && LOCAL:22 < LOCAL:24
			IF LOCAL:25 >= 1 && LOCAL:25 % 3 == 0
				PRINTL 
				LOCAL:26 ++
			ENDIF
			RESULT = 0
			TRYCALLFORM COM_FILTER_FORCE_OFF{LOCAL:0}
			IF RESULT
				SETCOLOR COLOR("パ緑")
				PRINTPLAINFORM [{LOCAL:0, 3}] %TRAINNAME:(LOCAL:0), 21, LEFT%
			ELSE
				IF COM_FILTER:(LOCAL:0)
					SETCOLOR COLOR("選択不可")
				ENDIF
				PRINTFORM [{LOCAL:0, 3}] %TRAINNAME:(LOCAL:0), 21, LEFT%
			ENDIF
			RESETCOLOR
			LOCAL:25 ++
		ENDIF
		LOCAL:22 ++
	ENDIF
NEXT
PRINTL 
DRAWLINE

PRINT [990] 前のページ     
PRINTPLAINFORM page{LOCAL:21}/{LOCAL:20}    
PRINTL [991] 次のページ


DRAWLINE
PRINTL [999] 決定

REDRAW 0

$INPUT_LOOP
INPUT

IF RESULT == 999
	REDRAW 1
	RETURN
ELSEIF RESULT == 990
	LOCAL:21 --
	IF LOCAL:21 < 1
		LOCAL:21 = LOCAL:20
	ENDIF
	CLEARLINE LOCAL:26
	GOTO SHOW_LOOP
ELSEIF RESULT == 991
	LOCAL:21 ++
	IF LOCAL:21 > LOCAL:20
		LOCAL:21 = 1
	ENDIF
	CLEARLINE LOCAL:26
	GOTO SHOW_LOOP
ELSEIF RESULT >= 0 && RESULT < 1000
	LOCAL:5 = RESULT
	IF TRAINNAME:(LOCAL:5) != ""
		RESULT = 0
		TRYCALLFORM COM_FILTER_FORCE_OFF{LOCAL:5}
		IF !RESULT
			COM_FILTER:(LOCAL:5) = !COM_FILTER:(LOCAL:5)
			CLEARLINE LOCAL:26
			GOTO SHOW_LOOP
		ENDIF
	ENDIF
ENDIF
CLEARLINE 1
GOTO INPUT_LOOP

;-------------------------------------------------
;継続フィルタ
;-------------------------------------------------
@CONFIG_EQUIP_FILTER
;ページ数の計算
LOCAL:20 = 0
FOR LOCAL:0, 0, 1000
	IF TRAINNAME:(LOCAL:0) != ""
		LOCAL:20 ++
	ENDIF
NEXT
LOCAL:20 = (LOCAL:20 - 1) / 66 + 1
LOCAL:21 = 1

DRAWLINE

$SHOW_LOOP

;コマンドの表示
LOCAL:22 = 0
LOCAL:23 = (LOCAL:21 - 1) * 66
LOCAL:24 = LOCAL:21 * 66
LOCAL:25 = 0
LOCAL:26 = 6
FOR LOCAL:0, 0, 1000
	IF TRAINNAME:(LOCAL:0) != ""
		IF LOCAL:22 >= LOCAL:23 && LOCAL:22 < LOCAL:24
			IF LOCAL:25 >= 1 && LOCAL:25 % 3 == 0
				PRINTL 
				LOCAL:26 ++
			ENDIF
			RESULT = 0
			TRYCALLFORM COM_IS_EQUIP{LOCAL:0}
			IF RESULT == 0
				SETCOLOR COLOR("暗緑")
				PRINTPLAINFORM [{LOCAL:0, 3}] %TRAINNAME:(LOCAL:0), 21, LEFT%
			ELSEIF RESULT == 2
				SETCOLOR COLOR("パ緑")
				PRINTPLAINFORM [{LOCAL:0, 3}] %TRAINNAME:(LOCAL:0), 21, LEFT%
			ELSE
				IF EQUIP_FILTER:(LOCAL:0)
					SETCOLOR COLOR("選択不可")
				ENDIF
				PRINTFORM [{LOCAL:0, 3}] %TRAINNAME:(LOCAL:0), 21, LEFT%
			ENDIF
			RESETCOLOR
			LOCAL:25 ++
		ENDIF
		LOCAL:22 ++
	ENDIF
NEXT
PRINTL 
DRAWLINE

PRINT [990] 前のページ     
PRINTPLAINFORM page{LOCAL:21}/{LOCAL:20}    
PRINTL [991] 次のページ


DRAWLINE
PRINTL [999] 決定

REDRAW 0

$INPUT_LOOP
INPUT

IF RESULT == 999
	REDRAW 1
	RETURN
ELSEIF RESULT == 990
	LOCAL:21 --
	IF LOCAL:21 < 1
		LOCAL:21 = LOCAL:20
	ENDIF
	CLEARLINE LOCAL:26
	GOTO SHOW_LOOP
ELSEIF RESULT == 991
	LOCAL:21 ++
	IF LOCAL:21 > LOCAL:20
		LOCAL:21 = 1
	ENDIF
	CLEARLINE LOCAL:26
	GOTO SHOW_LOOP
ELSEIF RESULT >= 0 && RESULT < 1000
	LOCAL:5 = RESULT
	IF TRAINNAME:(LOCAL:5) != ""
		RESULT = 0
		TRYCALLFORM COM_IS_EQUIP{LOCAL:5}
		IF RESULT != 0 && RESULT != 2
			EQUIP_FILTER:(LOCAL:5) = !EQUIP_FILTER:(LOCAL:5)
			CLEARLINE LOCAL:26
			GOTO SHOW_LOOP
		ENDIF
	ENDIF
ENDIF
CLEARLINE 1
GOTO INPUT_LOOP

;-------------------------------------------------
;キャラARG:0に応対する外来人の性別番号を、コンフィグの性別設定に基いて返す
;-------------------------------------------------
@GAIRAI_SEX_VS(ARG:0)
#FUNCTION
LOCAL:0 = TALENT:(ARG:0):性別
IF LOCAL:0 >= 0 && LOCAL:0 <= 5
	RETURNF (CONFIG:50 >> (LOCAL:0 * 4)) & 0b1111
ENDIF
RETURNF -1

;-------------------------------------------------
;0か1だけのCONFIG切り替え
;-------------------------------------------------
@CONFIG_TOGGLE(ARG)
	CONFIG:ARG ++
	CONFIG:ARG &= 0x1
RETURN 0
